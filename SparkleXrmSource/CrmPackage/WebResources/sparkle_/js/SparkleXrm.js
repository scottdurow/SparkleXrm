// SparkleXrm.js
var scriptLoader=scriptLoader||{delayedLoads:[],load:function(name,requires,script){window._loadedScripts=window._loadedScripts||{};if(requires==null||requires.length==0||scriptLoader.areLoaded(requires)){scriptLoader.runScript(name,script);} else{scriptLoader.delayedLoads.push({name:name,requires:requires,script:script});}},runScript:function(name,script){script.call(window);window._loadedScripts[name]=true;scriptLoader.onScriptLoaded(name);},onScriptLoaded:function(name){scriptLoader.delayedLoads.forEach(function(script){if(script.loaded==null&&scriptLoader.areLoaded(script.requires)){script.loaded=true;scriptLoader.runScript(script.name,script.script);}});},areLoaded:function(requires){var allLoaded=true;for(var i=0;i<requires.length;i++){var isLoaded=(window._loadedScripts[requires[i]]!=null);allLoaded=allLoaded&&isLoaded;if(!allLoaded)break;} return allLoaded;}};scriptLoader.load("xrm",["mscorlib"],function(){
Type.registerNamespace('SparkleXrm');Type.registerNamespace('SparkleXrm.Xrm');Type.registerNamespace('Xrm');SparkleXrm.ArrayEx=function(){}
SparkleXrm.ArrayEx.add=function(list,item){list[list.length]=item;}
SparkleXrm.ArrayEx.getEnumerator=function(list){return new ss.ArrayEnumerator(list);}
SparkleXrm.ArrayEx.join=function(list,delimeter){var $0='';for(var $1=0;$1<list.length;$1++){if($1>0){$0+=delimeter;}$0+=list[$1];}return $0;}
SparkleXrm.DelegateItterator=function(){}
SparkleXrm.DelegateItterator.callbackItterate=function(action,numberOfTimes,completeCallBack,errorCallBack){SparkleXrm.DelegateItterator.$0(action,0,numberOfTimes,completeCallBack,errorCallBack);}
SparkleXrm.DelegateItterator.$0=function($p0,$p1,$p2,$p3,$p4){if($p1<$p2){try{$p0($p1,function(){
$p1++;SparkleXrm.DelegateItterator.$0($p0,$p1,$p2,$p3,$p4);},function($p1_0){
$p4($p1_0);});}catch($0){$p4($0);}}else{$p3();}}
SparkleXrm.NumberEx=function(){}
SparkleXrm.NumberEx.parse=function(value,format){if(String.isNullOrEmpty(value)){return null;}value=value.replaceAll(' ','');value=value.replaceAll(format.numberSepartor,'');if(format.decimalSymbol!=='.'){value=value.replaceAll(format.decimalSymbol,'.');}if(value.startsWith('(')){value='-'+value.replaceAll('(','').replaceAll(')','');}else if(value.endsWith('-')){value='-'+value.substring(0,value.length-1);}var $0=Number.parse(value);return $0;}
SparkleXrm.NumberEx.getNumberFormatInfo=function(){var $0={};if(SparkleXrm.Sdk.OrganizationServiceProxy.userSettings!=null){$0.decimalSymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.decimalsymbol;$0.numberGroupFormat=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numbergroupformat;$0.numberSepartor=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numberseparator;$0.negativeFormatCode=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.negativeformatcode;}else{$0.decimalSymbol='.';$0.numberGroupFormat='3';$0.numberSepartor=',';$0.negativeFormatCode=0;}$0.precision=2;$0.minValue=-2147483648;$0.maxValue=2147483648;return $0;}
SparkleXrm.NumberEx.getCurrencyEditFormatInfo=function(){var $0={};if(SparkleXrm.Sdk.OrganizationServiceProxy.userSettings!=null){$0.decimalSymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.decimalsymbol;$0.numberGroupFormat=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numbergroupformat;$0.numberSepartor=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numberseparator;$0.negativeFormatCode=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.negativecurrencyformatcode;$0.precision=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.currencydecimalprecision;$0.currencySymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.currencysymbol;}else{$0.decimalSymbol='.';$0.numberGroupFormat='3';$0.numberSepartor=',';$0.negativeFormatCode=0;$0.precision=2;$0.currencySymbol='$';}return $0;}
SparkleXrm.NumberEx.getCurrencyFormatInfo=function(){var $0={};if(SparkleXrm.Sdk.OrganizationServiceProxy.userSettings!=null){$0.decimalSymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.decimalsymbol;$0.numberGroupFormat=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numbergroupformat;$0.numberSepartor=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.numberseparator;$0.negativeFormatCode=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.negativecurrencyformatcode;$0.precision=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.currencydecimalprecision;$0.currencySymbol=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.currencysymbol;}else{$0.decimalSymbol='.';$0.numberGroupFormat='3';$0.numberSepartor=',';$0.negativeFormatCode=0;$0.precision=2;$0.currencySymbol='$';}return $0;}
SparkleXrm.NumberEx.format=function(actualValue,format){if(actualValue==null){return '';}var $0=actualValue;var $1=format.numberGroupFormat.split(',');var $2='';if(format.precision!=null){$0.toFixed(format.precision);}var $3=Math.floor(Math.abs($0));var $4=$3.toString();var $5=$0.toString().substr($4.length+1+(($0<0)?1:0));var $6=$4.length;var $7=0;while($6>0){var $9=parseInt($1[$7]);if($7<($1.length-1)){$7++;}if(!$9){$9=$6+1;}$2=$4.substring($6,$6-$9)+$2;if($6>$9){$2=format.numberSepartor+$2;}$6=$6-$9;}var $8=($0<0);if(format.precision>0){var $A=format.precision-$5.length;for(var $B=0;$B<$A;$B++){$5=$5+'0';}$2=$2+format.decimalSymbol+$5;}if($8){switch(format.negativeFormatCode){case 0:$2='('+$2+')';break;case 2:$2='- '+$2;break;case 3:$2=$2+'-';break;case 4:$2=$2+' -';break;case 1:default:$2='-'+$2;break;}}return $2;}
SparkleXrm.NumberEx.round=function(numericValue,precision){var $0=1;if(precision>0){$0=Math.pow(10,precision);}return Math.round(numericValue*$0)/$0;}
SparkleXrm.NumberEx.getCurrencySymbol=function(currencyId){var $0=SparkleXrm.Services.CachedOrganizationService.retrieveMultiple("<fetch distinct='false' no-lock='false' mapping='logical'><entity name='organization'><attribute name='currencydisplayoption' /><attribute name='currencysymbol' /></entity></fetch>");var $1=$0.get_entities().get_item(0);var $2=SparkleXrm.Services.CachedOrganizationService.retrieve('transactioncurrency',currencyId.toString(),['currencysymbol','isocurrencycode']);if(!$1.getAttributeValueOptionSet('currencydisplayoption').value){return $2.getAttributeValueString('currencysymbol')+' ';}else{return $2.getAttributeValueString('isocurrencycode')+' ';}}
SparkleXrm.Xrm.PageEx=function(){}
SparkleXrm.Xrm.PageEx.getCacheKey=function(){var $0=WEB_RESOURCE_ORG_VERSION_NUMBER;if(typeof($0)!=='undefined'){return $0+'/';}else{return '';}}
SparkleXrm.Xrm.PageEx.getWebResourceData=function(){var $0=window.location.search;if($0!=null&&!!$0){var $1=$0.substr(1).split('&');var $enum1=ss.IEnumerator.getEnumerator($1);while($enum1.moveNext()){var $2=$enum1.current;if($2.toLowerCase().startsWith('data=')){var $3=$2.replaceAll('+',' ').split('=');return SparkleXrm.Xrm.PageEx.$0($3[1]);}}}return {};}
SparkleXrm.Xrm.PageEx.$0=function($p0){var $0={};var $1=(decodeURIComponent($p0)).split('&');var $enum1=ss.IEnumerator.getEnumerator($1);while($enum1.moveNext()){var $2=$enum1.current;var $3=$2.split('=');$0[$3[0]]=$3[1];}return $0;}
SparkleXrm.StringEx=function(){}
SparkleXrm.StringEx.IN=function(value,values){if(value!=null){var $enum1=ss.IEnumerator.getEnumerator(values);while($enum1.moveNext()){var $0=$enum1.current;if(value===$0){return true;}}}return false;}
SparkleXrm.TaskIterrator=function(){this.$0=[];}
SparkleXrm.TaskIterrator.prototype={$1:null,$2:null,addTask:function(task){this.$0.add(task);},start:function(successCallBack,errorCallBack){this.$1=errorCallBack;this.$2=successCallBack;this.$3();},$3:function(){var $0=this.$0[0];if($0!=null){this.$0.remove($0);$0(ss.Delegate.create(this,this.$3),this.$1);}else{if(this.$2!=null){this.$2();}}}}
Type.registerNamespace('SparkleXrm.ComponentModel');SparkleXrm.ComponentModel.INotifyPropertyChanged=function(){};SparkleXrm.ComponentModel.INotifyPropertyChanged.registerInterface('SparkleXrm.ComponentModel.INotifyPropertyChanged');Type.registerNamespace('SparkleXrm.Sdk');SparkleXrm.Sdk.EntityStates=function(){};SparkleXrm.Sdk.EntityStates.prototype = {unchanged:0,created:1,changed:2,deleted:3,readOnly:4}
SparkleXrm.Sdk.EntityStates.registerEnum('SparkleXrm.Sdk.EntityStates',false);SparkleXrm.Sdk.EntityRole=function(){};SparkleXrm.Sdk.EntityRole.prototype = {referencing:0,referenced:1}
SparkleXrm.Sdk.EntityRole.registerEnum('SparkleXrm.Sdk.EntityRole',false);SparkleXrm.Sdk.Attribute=function(attributeName,typeName){this.attributeName=attributeName;this.typeName=typeName;this.formattedValue=null;this.value=null;this.id=null;this.logicalName=null;this.name=null;}
SparkleXrm.Sdk.Attribute.deSerialise=function(node,overrideType){var $0=(SparkleXrm.Sdk.XmlHelper.getAttributeValue(node,'i:nil')==='true');var $1=null;if(!$0){var $2=overrideType;if($2==null){$2=SparkleXrm.Sdk.Attribute.$0(SparkleXrm.Sdk.XmlHelper.getAttributeValue(node,'i:type'));}var $3=SparkleXrm.Sdk.XmlHelper.getNodeTextValue(node);switch($2){case 'EntityReference':var $4=new SparkleXrm.Sdk.EntityReference(new SparkleXrm.Sdk.Guid(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'Id')),SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'LogicalName'),SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'Name'));$1=$4;break;case 'AliasedValue':$1=SparkleXrm.Sdk.Attribute.deSerialise(SparkleXrm.Sdk.XmlHelper.selectSingleNode(node,'Value'),null);break;case 'boolean':$1=($3==='true');break;case 'double':$1=parseFloat($3);break;case 'decimal':$1=parseFloat($3);break;case 'dateTime':var $5=SparkleXrm.Sdk.DateTimeEx.parse($3);var $6=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings;if($6!=null){$5.setTime($5.getTime()+($5.getTimezoneOffset()*60*1000));var $7=SparkleXrm.Sdk.DateTimeEx.utcToLocalTimeFromSettings($5,$6);$1=$7;}else{$1=$5;}break;case 'guid':$1=new SparkleXrm.Sdk.Guid($3);break;case 'int':$1=parseInt($3);break;case 'OptionSetValue':$1=SparkleXrm.Sdk.OptionSetValue.parse(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'Value'));break;case 'Money':$1=new SparkleXrm.Sdk.Money(parseFloat(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'Value')));break;case 'EntityCollection':$1=SparkleXrm.Sdk.EntityCollection.deSerialise(node);break;default:$1=$3;break;}}return $1;}
SparkleXrm.Sdk.Attribute.serialise=function(attributeName,value,metaData){var $0='<a:KeyValuePairOfstringanyType><b:key>'+attributeName+'</b:key>';var $1=Type.getInstanceType(value).get_name();if(value!=null&&metaData!=null&&Object.keyExists(metaData,attributeName)){$1=metaData[attributeName];}$0+=SparkleXrm.Sdk.Attribute.serialiseValue(value,$1);$0+='</a:KeyValuePairOfstringanyType>';return $0;}
SparkleXrm.Sdk.Attribute.serialiseValue=function(value,overrideTypeName){var $0='';var $1=overrideTypeName;if($1==null){$1=Type.getInstanceType(value).get_name();}switch($1){case 'String':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('string')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';$0+=SparkleXrm.Sdk.XmlHelper.encode(value);$0+='</b:value>';break;case 'Boolean':case 'bool':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('boolean')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';$0+=SparkleXrm.Sdk.XmlHelper.encode(value.toString());$0+='</b:value>';break;case 'Date':var $2=value;var $3=null;var $4=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings;if($4!=null){var $D=SparkleXrm.Sdk.DateTimeEx.localTimeToUTCFromSettings($2,$4);$3=SparkleXrm.Sdk.DateTimeEx.toXrmString($D);}else{$3=SparkleXrm.Sdk.DateTimeEx.toXrmStringUTC($2);}$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('dateTime')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';$0+=SparkleXrm.Sdk.XmlHelper.encode($3);$0+='</b:value>';break;case 'decimal':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('decimal')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';var $5=null;if(value!=null){$5=value.toString();}$0+=SparkleXrm.Sdk.XmlHelper.encode($5);$0+='</b:value>';break;case 'double':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('double')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';var $6=null;if(value!=null){$6=value.toString();}$0+=SparkleXrm.Sdk.XmlHelper.encode($6);$0+='</b:value>';break;case 'int':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('int')+'" xmlns:c="http://www.w3.org/2001/XMLSchema">';var $7=null;if(value!=null){$7=value.toString();}$0+=SparkleXrm.Sdk.XmlHelper.encode($7);$0+='</b:value>';break;case 'Guid':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1('guid')+'" xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/">';$0+=(value).value;$0+='</b:value>';break;case 'EntityReference':var $8=value;$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'">';$0+='<a:Id>'+$8.id+'</a:Id><a:LogicalName>'+$8.logicalName+'</a:LogicalName>';$0+='</b:value>';break;case 'OptionSetValue':var $9=value;if($9.value!=null){$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'">';$0+='<a:Value>'+$9.value+'</a:Value>';$0+='</b:value>';}else{$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'" i:nil="true"/>';}break;case 'EntityCollection':$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'">';$0+=SparkleXrm.Sdk.EntityCollection.serialise(value);$0+='</b:value>';break;case 'Money':var $A=value;if($A!=null&&$A.value!=null){$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'">';$0+='<a:Value>'+$A.value.toString()+'</a:Value>';$0+='</b:value>';}else{$0+='<b:value i:type="'+SparkleXrm.Sdk.Attribute.$1($1)+'" i:nil="true"/>';}break;case 'EntityFilters':var $B=value;var $C=[];if((1&$B)===1){$C.add('Entity');}if((2&$B)===2){$C.add('Attributes');}if((4&$B)===4){$C.add('Privileges');}if((8&$B)===8){$C.add('Relationships');}$0+='<b:value i:type="c:EntityFilters" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata">'+SparkleXrm.Sdk.XmlHelper.encode($C.join(' '))+'</b:value>';break;default:$0+='<b:value i:nil="true"/>';break;}return $0;}
SparkleXrm.Sdk.Attribute.$0=function($p0){var $0=$p0.indexOf(':');return $p0.substring($0+1,$p0.length-$0+1);}
SparkleXrm.Sdk.Attribute.$1=function($p0){switch($p0){case 'String':case 'Guid':case 'DateTime':case 'string':case 'decimal':case 'double':case 'boolean':case 'dateTime':case 'guid':case 'int':return 'c:'+$p0;case 'EntityReference':case 'OptionSetValue':case 'AliasedValue':case 'EntityCollection':case 'Money':return 'a:'+$p0;}throw new Error('Could not add node prefix for type '+$p0);}
SparkleXrm.Sdk.Attribute.prototype={attributeName:null,typeName:null,formattedValue:null,value:null,id:null,logicalName:null,name:null}
SparkleXrm.Sdk.AttributeTypes=function(){}
SparkleXrm.Sdk.OrganizationSettings=function(){SparkleXrm.Sdk.OrganizationSettings.initializeBase(this,[SparkleXrm.Sdk.OrganizationSettings.entityLogicalName]);}
SparkleXrm.Sdk.OrganizationSettings.prototype={weekstartdaycode:null}
SparkleXrm.Sdk.UserSettingsAttributes=function(){}
SparkleXrm.Sdk.UserSettings=function(){SparkleXrm.Sdk.UserSettings.initializeBase(this,[SparkleXrm.Sdk.UserSettings.entityLogicalName]);}
SparkleXrm.Sdk.UserSettings.prototype={usersettingsid:null,businessunitid:null,calendartype:null,currencydecimalprecision:null,currencyformatcode:null,currencysymbol:null,dateformatcode:null,dateformatstring:null,dateseparator:null,decimalsymbol:null,defaultcalendarview:null,defaultdashboardid:null,localeid:null,longdateformatcode:null,negativecurrencyformatcode:null,negativeformatcode:null,numbergroupformat:null,numberseparator:null,offlinesyncinterval:null,pricingdecimalprecision:null,showweeknumber:null,systemuserid:null,timeformatcodestring:null,timeformatstring:null,timeseparator:null,timezonebias:null,timezonecode:null,timezonedaylightbias:null,timezonedaylightday:null,timezonedaylightdayofweek:null,timezonedaylighthour:null,timezonedaylightminute:null,timezonedaylightmonth:null,timezonedaylightsecond:null,timezonedaylightyear:null,timezonestandardbias:null,timezonestandardday:null,timezonestandarddayofweek:null,timezonestandardhour:null,timezonestandardminute:null,timezonestandardmonth:null,timezonestandardsecond:null,timezonestandardyear:null,transactioncurrencyid:null,uilanguageid:null,workdaystarttime:null,workdaystoptime:null,getNumberFormatString:function(decimalPlaces){return '###,###,###.000';}}
SparkleXrm.Sdk.DataCollectionOfEntity=function(entities){this._internalArray=entities;}
SparkleXrm.Sdk.DataCollectionOfEntity.prototype={_internalArray:null,items:function(){return this._internalArray;},getEnumerator:function(){return SparkleXrm.ArrayEx.getEnumerator(this._internalArray);},get_count:function(){return this._internalArray.length;},get_item:function(i){return this._internalArray[i];},set_item:function(i,value){this._internalArray[i]=value;return value;}}
SparkleXrm.Sdk.DateTimeEx=function(){}
SparkleXrm.Sdk.DateTimeEx.toXrmString=function(date){var $0=SparkleXrm.Sdk.DateTimeEx.$0(date.getMonth()+1,2);var $1=SparkleXrm.Sdk.DateTimeEx.$0(date.getDate(),2);var $2=SparkleXrm.Sdk.DateTimeEx.$0(date.getHours(),2);var $3=SparkleXrm.Sdk.DateTimeEx.$0(date.getMinutes(),2);var $4=SparkleXrm.Sdk.DateTimeEx.$0(date.getSeconds(),2);return String.format('{0}-{1}-{2}T{3}:{4}:{5}Z',date.getFullYear(),$0,$1,$2,$3,$4);}
SparkleXrm.Sdk.DateTimeEx.toXrmStringUTC=function(date){var $0=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCMonth()+1,2);var $1=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCDate(),2);var $2=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCHours(),2);var $3=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCMinutes(),2);var $4=SparkleXrm.Sdk.DateTimeEx.$0(date.getUTCSeconds(),2);return String.format('{0}-{1}-{2}T{3}:{4}:{5}Z',date.getUTCFullYear(),$0,$1,$2,$3,$4);}
SparkleXrm.Sdk.DateTimeEx.$0=function($p0,$p1){var $0=$p0.toString();while($0.length<$p1){$0='0'+$0;}return $0;}
SparkleXrm.Sdk.DateTimeEx.parse=function(dateString){if(!String.isNullOrEmpty(dateString)){var $0=(Date.parseDate(dateString));return $0;}else{return null;}}
SparkleXrm.Sdk.DateTimeEx.formatDuration=function(totalMinutes){if(totalMinutes!=null){var $0=totalMinutes*60;var $1=Math.floor($0/86400);var $2=Math.floor(($0%86400)/3600);var $3=Math.floor((($0%86400)%3600)/60);var $4=(($0%86400)%3600)%60;var $5=[];if($1>0){SparkleXrm.ArrayEx.add($5,'{0}d');}if($2>0){SparkleXrm.ArrayEx.add($5,'{1}h');}if($3>0){SparkleXrm.ArrayEx.add($5,'{2}m');}if(!$1&&!$2&&!$3){SparkleXrm.ArrayEx.add($5,'{2}m');}return String.format(SparkleXrm.ArrayEx.join($5,' '),$1,$2,$3);}else{return '';}}
SparkleXrm.Sdk.DateTimeEx.parseDuration=function(duration){var $0=(duration==null)||(!duration.length);if($0){return null;}var $1='/([0-9.]*)[ ]?((h(our)?[s]?)|(m(inute)?[s]?)|(d(ay)?[s]?))/g';var $2=RegExp.parse($1);var $3=false;var $4=false;var $5=0;do{var $6=$2.exec(duration);$4=($6!=null&&$6.length>0);$3=$3||$4;if($4){var $7=parseFloat($6[1]);switch($6[2].substr(0,1).toLowerCase()){case 'd':$7=$7*60*24;break;case 'h':$7=$7*60;break;}$5+=Math.floor($7);duration.replaceAll($6[0],'');}}while($4);if($3){return $5;}else{return null;}}
SparkleXrm.Sdk.DateTimeEx.addTimeToDate=function(date,time){if(date==null){date=Date.get_now();}if(time!=null){var $0=Date.parseDate('01 Jan 2000 '+time.replaceAll('.',':').replaceAll('-',':').replaceAll(',',':'));var $1=new Date(date.getTime());if(!isNaN(($0))){$1.setHours($0.getHours());$1.setMinutes($0.getMinutes());$1.setSeconds($0.getSeconds());$1.setMilliseconds($0.getMilliseconds());return $1;}return null;}return date;}
SparkleXrm.Sdk.DateTimeEx.localTimeToUTCFromSettings=function(LocalTime,settings){return SparkleXrm.Sdk.DateTimeEx.localTimeToUTC(LocalTime,settings.timezonebias,settings.timezonedaylightbias,settings.timezonedaylightyear,settings.timezonedaylightmonth,settings.timezonedaylightday,settings.timezonedaylighthour,settings.timezonedaylightminute,settings.timezonedaylightsecond,0,settings.timezonedaylightdayofweek,settings.timezonestandardbias,settings.timezonestandardyear,settings.timezonestandardmonth,settings.timezonestandardday,settings.timezonestandardhour,settings.timezonestandardminute,settings.timezonestandardsecond,0,settings.timezonestandarddayofweek);}
SparkleXrm.Sdk.DateTimeEx.localTimeToUTC=function(LocalTime,Bias,DaylightBias,DaylightYear,DaylightMonth,DaylightDay,DaylightHour,DaylightMinute,DaylightSecond,DaylightMilliseconds,DaylightWeekday,StandardBias,StandardYear,StandardMonth,StandardDay,StandardHour,StandardMinute,StandardSecond,StandardMilliseconds,StandardWeekday){var $0;var $1;var $2;var $3;var $4;var $5;var $6;$1=Bias;if((!!StandardMonth)&&(!!DaylightMonth)){$3=SparkleXrm.Sdk.DateTimeEx.$1(LocalTime,StandardYear,StandardMonth,StandardDay,StandardHour,StandardMinute,StandardSecond,StandardMilliseconds,StandardWeekday);if($3==null){return null;}$4=SparkleXrm.Sdk.DateTimeEx.$1(LocalTime,DaylightYear,DaylightMonth,DaylightDay,DaylightHour,DaylightMinute,DaylightSecond,DaylightMilliseconds,DaylightWeekday);if($4==null){return null;}if($4<$3){if((LocalTime>=$4)&&(LocalTime<$3)){$6=true;}else{$6=false;}}else{if((LocalTime>=$3)&&(LocalTime<$4)){$6=false;}else{$6=true;}}if($6){$2=DaylightBias;}else{$2=StandardBias;}$0=$1+$2;}else{$0=$1;}$5=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$0,LocalTime);return $5;}
SparkleXrm.Sdk.DateTimeEx.utcToLocalTimeFromSettings=function(UTCTime,settings){return SparkleXrm.Sdk.DateTimeEx.utcToLocalTime(UTCTime,settings.timezonebias,settings.timezonedaylightbias,settings.timezonedaylightyear,settings.timezonedaylightmonth,settings.timezonedaylightday,settings.timezonedaylighthour,settings.timezonedaylightminute,settings.timezonedaylightsecond,0,settings.timezonedaylightdayofweek,settings.timezonestandardbias,settings.timezonestandardyear,settings.timezonestandardmonth,settings.timezonestandardday,settings.timezonestandardhour,settings.timezonestandardminute,settings.timezonestandardsecond,0,settings.timezonestandarddayofweek);}
SparkleXrm.Sdk.DateTimeEx.utcToLocalTime=function(UTCTime,Bias,DaylightBias,DaylightYear,DaylightMonth,DaylightDay,DaylightHour,DaylightMinute,DaylightSecond,DaylightMilliseconds,DaylightWeekday,StandardBias,StandardYear,StandardMonth,StandardDay,StandardHour,StandardMinute,StandardSecond,StandardMilliseconds,StandardWeekday){var $0=0;var $1=0;var $2=0;var $3;var $4;var $5;var $6;var $7;var $8;$1=Bias;if((!!StandardMonth)&&(!!DaylightMonth)){$3=SparkleXrm.Sdk.DateTimeEx.$1(UTCTime,StandardYear,StandardMonth,StandardDay,StandardHour,StandardMinute,StandardSecond,StandardMilliseconds,StandardWeekday);if($3==null){return null;}$4=SparkleXrm.Sdk.DateTimeEx.$1(UTCTime,DaylightYear,DaylightMonth,DaylightDay,DaylightHour,DaylightMinute,DaylightSecond,DaylightMilliseconds,DaylightWeekday);if($4==null){return null;}$2=StandardBias;$0=$1+$2;$6=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$0,$4);$2=DaylightBias;$0=$1+$2;$5=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$0,$3);if($6<$5){if((UTCTime>=$6)&&(UTCTime<$5)){$8=true;}else{$8=false;}}else{if((UTCTime>=$5)&&(UTCTime<$6)){$8=false;}else{$8=true;}}if($8){$2=DaylightBias;}else{$2=StandardBias;}$0=$1+$2;}else{$0=$1;}$7=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$0*-1,UTCTime);return $7;}
SparkleXrm.Sdk.DateTimeEx.$1=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7,$p8){if(!!$p1){return null;}var $0;var $1;var $2;var $3;var $4;var $5;var $6;var $7;$4=$p3;if(($4>5)||(!$4)){return null;}$7=$p8;$6=$p2;$5=$p0.getFullYear();$2=0;$0=SparkleXrm.Sdk.DateTimeEx.firstDayOfMonth($p0,$6);$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('hours',$p4,$0);$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('minutes',$p5,$0);$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('seconds',$p6,$0);$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('milliseconds',$p7,$0);$1=$0;if($1.getDay()>$7){$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',(7-($1.getDay()-$7)),$0);}else if($1.getDay()<$7){$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',($7-$1.getDay()),$0);}$2=$0.getDay();$3=1;$1=$0;while($3<$4){$0=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',7,$0);if($0.getMonth()!==$1.getMonth()){break;}$1=$0;$3=$3+1;}return $1;}
SparkleXrm.Sdk.DateTimeEx.firstDayOfMonth=function(date,Month){var $0=new Date(date.getTime());$0.setMonth(Month-1);$0.setDate(1);$0.setHours(0);$0.setMinutes(0);$0.setSeconds(0);$0.setMilliseconds(0);return $0;}
SparkleXrm.Sdk.DateTimeEx.dateAdd=function(interval,value,date){var $0=date.getTime();var $1;switch(interval){case 'milliseconds':$1=new Date($0+value);break;case 'seconds':$1=new Date($0+(value*1000));break;case 'minutes':$1=new Date($0+(value*1000*60));break;case 'hours':$1=new Date($0+(value*1000*60*60));break;case 'days':$1=new Date($0+(value*1000*60*60*24));break;default:$1=date;break;}return $1;}
SparkleXrm.Sdk.DateTimeEx.firstDayOfWeek=function(date){var $0=0;if(SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings!=null){$0=SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings.weekstartdaycode.value;}var $1=new Date(date.getTime());var $2=$1.getDay();$2=$2-$0;if($2<0){$2=7+$2;}if($2>0){$1=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',($2*-1),$1);}$1.setHours(0);$1.setMinutes(0);$1.setSeconds(0);$1.setMilliseconds(0);return $1;}
SparkleXrm.Sdk.DateTimeEx.lastDayOfWeek=function(date){var $0=0;if(SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings!=null){$0=SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings.weekstartdaycode.value;}var $1=new Date(date.getTime());var $2=$1.getDay();$2=$2-$0;if($2<0){$2=7+$2;}$1=SparkleXrm.Sdk.DateTimeEx.dateAdd('days',(6-$2),$1);$1.setHours(23);$1.setMinutes(59);$1.setSeconds(59);$1.setMilliseconds(999);return $1;}
SparkleXrm.Sdk.DateTimeEx.formatTimeSpecific=function(dateValue,formatString){formatString=formatString.replaceAll('.',':').replaceAll('-',':').replaceAll(',',':');if(dateValue!=null&&(Date===Type.getInstanceType(dateValue))){return dateValue.format(formatString);}else{return '';}}
SparkleXrm.Sdk.DateTimeEx.formatDateSpecific=function(dateValue,formatString){if(dateValue!=null){return xrmjQuery.datepicker.formatDate( formatString, dateValue );}else{return '';}}
SparkleXrm.Sdk.DateTimeEx.parseDateSpecific=function(dateValue,formatString){return xrmjQuery.datepicker.parseDate( formatString, dateValue );}
SparkleXrm.Sdk.DateTimeEx.setTime=function(date,time){if(date!=null&&time!=null){date.setHours(time.getHours());date.setMinutes(time.getMinutes());date.setSeconds(time.getSeconds());date.setMilliseconds(time.getMilliseconds());}}
SparkleXrm.Sdk.DateTimeEx.setUTCTime=function(date,time){if(date!=null&&time!=null){date.setUTCHours(time.getUTCHours());date.setUTCMinutes(time.getUTCMinutes());date.setUTCSeconds(time.getUTCSeconds());date.setUTCMilliseconds(time.getUTCMilliseconds());}}
SparkleXrm.Sdk.DateTimeEx.getTimeDuration=function(date){return (date.getHours()*(60*60))+(date.getMinutes()*60)+date.getSeconds();}
SparkleXrm.Sdk.Entity=function(entityName){this._metaData={};this.logicalName=entityName;this.$0={};this.formattedValues={};}
SparkleXrm.Sdk.Entity.sortDelegate=function(attributeName,a,b){var $0=a.getAttributeValue(attributeName);var $1=b.getAttributeValue(attributeName);var $2=0;var $3='';if($0!=null){$3=Type.getInstanceType($0).get_name();}else if($1!=null){$3=Type.getInstanceType($1).get_name();}if($0!==$1){switch($3.toLowerCase()){case 'string':$0=($0!=null)?($0).toLowerCase():null;$1=($1!=null)?($1).toLowerCase():null;if($0<$1){$2=-1;}else{$2=1;}break;case 'date':if($0==null){$2=-1;}else if($1==null){$2=1;}else if($0<$1){$2=-1;}else{$2=1;}break;case 'number':var $4=($0!=null)?($0):0;var $5=($1!=null)?($1):0;$2=($4-$5);break;case 'money':var $6=($0!=null)?($0).value:0;var $7=($1!=null)?($1).value:0;$2=($6-$7);break;case 'optionsetvalue':var $8=($0!=null)?($0).value:0;$8=($8!=null)?$8:0;var $9=($1!=null)?($1).value:0;$9=($9!=null)?$9:0;$2=($8-$9);break;case 'entityreference':var $A=(($0!=null)&&(($0).name!=null))?($0).name:'';var $B=($1!=null&&(($1).name!=null))?($1).name:'';if($A<$B){$2=-1;}else{$2=1;}break;}}return $2;}
SparkleXrm.Sdk.Entity.prototype={logicalName:null,id:null,entityState:0,$0:null,formattedValues:null,relatedEntities:null,deSerialise:function(entityNode){this.logicalName=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(entityNode,'LogicalName');this.id=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(entityNode,'Id');var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(entityNode,'Attributes');var $1=$0.childNodes.length;for(var $4=0;$4<$1;$4++){var $5=$0.childNodes[$4];try{var $6=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($5,'key');var $7=SparkleXrm.Sdk.Attribute.deSerialise(SparkleXrm.Sdk.XmlHelper.selectSingleNode($5,'value'),null);this.$0[$6]=$7;this.$1($6,$7);}catch($8){throw new Error('Invalid Attribute Value :'+SparkleXrm.Sdk.XmlHelper.getNodeTextValue($5)+':'+$8.message);}}var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode(entityNode,'FormattedValues');if($2!=null){for(var $9=0;$9<$2.childNodes.length;$9++){var $A=$2.childNodes[$9];var $B=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($A,'key');var $C=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($A,'value');this.$1($B+'name',$C);this.formattedValues[$B+'name']=$C;var $D=this.$0[$B];if($D!=null){$D.name=$C;}}}var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode(entityNode,'RelatedEntities');if($3!=null){var $E={};for(var $F=0;$F<$3.childNodes.length;$F++){var $10=$3.childNodes[$F];var $11=SparkleXrm.Sdk.XmlHelper.selectSingleNode($10,'key');var $12=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($11,'SchemaName');var $13=new SparkleXrm.Sdk.Relationship($12);var $14=SparkleXrm.Sdk.XmlHelper.selectSingleNode($10,'value');var $15=SparkleXrm.Sdk.EntityCollection.deSerialise($14);$E[$13.schemaName]=$15;}this.relatedEntities=$E;}},$1:function($p0,$p1){var $0=this;var $1=Type.safeCast($0,Object);$1[$p0]=$p1;},serialise:function(ommitRoot){var $0='';if(ommitRoot==null||!ommitRoot){$0+='<a:Entity>';}$0+='<a:Attributes>';var $1=(this);if($1[this.logicalName+'id']==null){delete $1[this.logicalName+'id'];}var $enum1=ss.IEnumerator.getEnumerator(Object.keys($1));while($enum1.moveNext()){var $2=$enum1.current;if(typeof($1[$2])!="function"&&Object.prototype.hasOwnProperty.call(this, $2)&&!SparkleXrm.StringEx.IN($2,['id','logicalName','entityState','formattedValues','relatedEntities'])&&!$2.startsWith('$')&&!$2.startsWith('_')){var $3=$1[$2];if(!Object.keyExists(this.formattedValues,$2)){$0+=SparkleXrm.Sdk.Attribute.serialise($2,$3,this._metaData);}}}$0+='</a:Attributes>';$0+='<a:LogicalName>'+this.logicalName+'</a:LogicalName>';if(this.id!=null){$0+='<a:Id>'+this.id+'</a:Id>';}if(ommitRoot==null||!ommitRoot){$0+='</a:Entity>';}return $0;},setAttributeValue:function(name,value){this.$0[name]=value;this.$1(name,value);},getAttributeValue:function(attributeName){return this[attributeName];},getAttributeValueOptionSet:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueGuid:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueInt:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueFloat:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueString:function(attributeName){return this.getAttributeValue(attributeName);},getAttributeValueEntityReference:function(attributeName){return this.getAttributeValue(attributeName);},raisePropertyChanged:function(propertyName){var $0={};$0.propertyName=propertyName;if(this.$2!=null){this.$2(this,$0);}if(propertyName!=='EntityState'&&!this.entityState&&this.entityState!==1){this.entityState=2;}},toEntityReference:function(){return new SparkleXrm.Sdk.EntityReference(new SparkleXrm.Sdk.Guid(this.id),this.logicalName,'');},add_propertyChanged:function(value){this.$2=ss.Delegate.combine(this.$2,value);},remove_propertyChanged:function(value){this.$2=ss.Delegate.remove(this.$2,value);},$2:null}
SparkleXrm.Sdk.EntityCollection=function(entities){this.$0=new SparkleXrm.Sdk.DataCollectionOfEntity(entities);}
SparkleXrm.Sdk.EntityCollection.serialise=function(value){var $0='';if(Type.getInstanceType(value)!==SparkleXrm.Sdk.EntityCollection){throw new Error("An attribute value of type 'EntityCollection' must contain an EntityCollection instance");}var $1=Type.safeCast(value,SparkleXrm.Sdk.EntityCollection);$0+='<a:Entities>';for(var $2=0;$2<$1.$0.get_count();$2++){$0+=($1.get_item($2)).serialise(false);}$0+='</a:Entities>';return $0;}
SparkleXrm.Sdk.EntityCollection.deSerialise=function(node){var $0=[];var $1=new SparkleXrm.Sdk.EntityCollection($0);$1.set_entityName(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(node,'EntityName'));var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep(node,'Entities');var $enum1=ss.IEnumerator.getEnumerator($2.childNodes);while($enum1.moveNext()){var $3=$enum1.current;var $4=new SparkleXrm.Sdk.Entity($1.get_entityName());$4.deSerialise($3);SparkleXrm.ArrayEx.add($0,$4);}return $1;}
SparkleXrm.Sdk.EntityCollection.prototype={$0:null,get_entities:function(){return this.$0;},set_entities:function(value){this.$0=value;return value;},$1:null,get_entityName:function(){return this.$1;},set_entityName:function(value){this.$1=value;return value;},$2:null,get_minActiveRowVersion:function(){return this.$2;},set_minActiveRowVersion:function(value){this.$2=value;return value;},$3:false,get_moreRecords:function(){return this.$3;},set_moreRecords:function(value){this.$3=value;return value;},$4:null,get_pagingCookie:function(){return this.$4;},set_pagingCookie:function(value){this.$4=value;return value;},$5:0,get_totalRecordCount:function(){return this.$5;},set_totalRecordCount:function(value){this.$5=value;return value;},$6:false,get_totalRecordCountLimitExceeded:function(){return this.$6;},set_totalRecordCountLimitExceeded:function(value){this.$6=value;return value;},get_item:function(index){return this.get_entities().get_item(index);},set_item:function(index,value){this.get_entities().set_item(index,value);return value;}}
SparkleXrm.Sdk.EntityReference=function(Id,LogicalName,Name){this.id=Id;this.logicalName=LogicalName;this.name=Name;}
SparkleXrm.Sdk.EntityReference.prototype={name:null,id:null,logicalName:null,toString:function(){return String.format('[EntityReference: {0},{1},{2}]',this.name,this.id,this.logicalName);},toSoap:function(NameSpace){if(NameSpace==null||!NameSpace){NameSpace='a';}return String.format('<{0}:EntityReference><{0}:Id>{1}</{0}:Id><{0}:LogicalName>{2}</{0}:LogicalName><{0}:Name i:nil="true" /></{0}:EntityReference>',NameSpace,this.id.value,this.logicalName);}}
SparkleXrm.Sdk.Guid=function(Value){this.value=Value;}
SparkleXrm.Sdk.Guid.prototype={value:null,toString:function(){return this.value;}}
SparkleXrm.Sdk.Money=function(value){this.value=value;}
SparkleXrm.Sdk.Money.prototype={value:0}
SparkleXrm.Sdk.OptionSetValue=function(value){this.value=value;}
SparkleXrm.Sdk.OptionSetValue.parse=function(value){if(String.isNullOrEmpty(value)){return new SparkleXrm.Sdk.OptionSetValue(null);}else{return new SparkleXrm.Sdk.OptionSetValue(parseInt(value));}}
SparkleXrm.Sdk.OptionSetValue.prototype={name:null,value:null}
SparkleXrm.Sdk.OrganizationServiceProxy=function(){}
SparkleXrm.Sdk.OrganizationServiceProxy.registerExecuteMessageResponseType=function(responseTypeName,organizationResponseType){SparkleXrm.Sdk.OrganizationServiceProxy.executeMessageResponseTypes[responseTypeName]=organizationResponseType;}
SparkleXrm.Sdk.OrganizationServiceProxy.getUserSettings=function(){if(SparkleXrm.Sdk.OrganizationServiceProxy.userSettings==null){SparkleXrm.Sdk.OrganizationServiceProxy.userSettings=SparkleXrm.Sdk.OrganizationServiceProxy.retrieve(SparkleXrm.Sdk.UserSettings.entityLogicalName,Xrm.Page.context.getUserId(),['AllColumns']);SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.timeformatstring=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.timeformatstring.replaceAll(':',SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.timeseparator);SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateformatstring=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateformatstring.replaceAll('/',SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateseparator);SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateformatstring=SparkleXrm.Sdk.OrganizationServiceProxy.userSettings.dateformatstring.replaceAll('MM','mm').replaceAll('yyyy','UU').replaceAll('yy','y').replaceAll('UU','yy').replaceAll('M','m');}if(SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings==null){var $0="<fetch>\r\n                                    <entity name='organization' >\r\n                                        <attribute name='weekstartdaycode' />\r\n                                    </entity>\r\n                                </fetch>";SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings=SparkleXrm.Sdk.OrganizationServiceProxy.retrieveMultiple($0).get_entities().get_item(0);}return SparkleXrm.Sdk.OrganizationServiceProxy.userSettings;}
SparkleXrm.Sdk.OrganizationServiceProxy.doesNNAssociationExist=function(relationship,Entity1,Entity2){var $0="<fetch mapping='logical'>"+"  <entity name='"+relationship.schemaName+"'>"+'    <all-attributes />'+'    <filter>'+"      <condition attribute='"+Entity1.logicalName+"id' operator='eq' value ='"+Entity1.id.value+"' />"+"      <condition attribute='"+Entity2.logicalName+"id' operator='eq' value='"+Entity2.id.value+"' />"+'    </filter>'+'  </entity>'+'</fetch>';var $1=SparkleXrm.Sdk.OrganizationServiceProxy.retrieveMultiple($0);if($1.get_entities().get_count()>0){return true;}return false;}
SparkleXrm.Sdk.OrganizationServiceProxy.associate=function(entityName,entityId,relationship,relatedEntities){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$0(entityName,entityId,relationship,relatedEntities),'Execute',null);delete $0;$0=null;}
SparkleXrm.Sdk.OrganizationServiceProxy.beginAssociate=function(entityName,entityId,relationship,relatedEntities,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$0(entityName,entityId,relationship,relatedEntities),'Execute',callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endAssociate=function(asyncState){var $0=asyncState;if($0.childNodes!=null){}else{throw asyncState;}}
SparkleXrm.Sdk.OrganizationServiceProxy.$0=function($p0,$p1,$p2,$p3){var $0='';var $enum1=ss.IEnumerator.getEnumerator($p3);while($enum1.moveNext()){var $2=$enum1.current;$0+=$2.toSoap('a');}var $1='<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">';$1+='      <request i:type="a:AssociateRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">';$1+='        <a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">';$1+='          <a:KeyValuePairOfstringanyType>';$1+='            <b:key>Target</b:key>';$1+='            <b:value i:type="a:EntityReference">';$1+='              <a:Id>'+$p1.value+'</a:Id>';$1+='              <a:LogicalName>'+$p0+'</a:LogicalName>';$1+='              <a:Name i:nil="true" />';$1+='            </b:value>';$1+='          </a:KeyValuePairOfstringanyType>';$1+='          <a:KeyValuePairOfstringanyType>';$1+='            <b:key>Relationship</b:key>';$1+='            <b:value i:type="a:Relationship">';$1+='              <a:PrimaryEntityRole i:nil="true" />';$1+='              <a:SchemaName>'+$p2.schemaName+'</a:SchemaName>';$1+='            </b:value>';$1+='          </a:KeyValuePairOfstringanyType>';$1+='          <a:KeyValuePairOfstringanyType>';$1+='            <b:key>RelatedEntities</b:key>';$1+='            <b:value i:type="a:EntityReferenceCollection">'+$0+'</b:value>';$1+='          </a:KeyValuePairOfstringanyType>';$1+='        </a:Parameters>';$1+='        <a:RequestId i:nil="true" />';$1+='        <a:RequestName>Associate</a:RequestName>';$1+='      </request>';$1+='    </Execute>';return $1;}
SparkleXrm.Sdk.OrganizationServiceProxy.disassociate=function(entityName,entityId,relationship,relatedEntities){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$1(entityName,entityId,relationship,relatedEntities),'Execute',null);delete $0;$0=null;}
SparkleXrm.Sdk.OrganizationServiceProxy.beginDisassociate=function(entityName,entityId,relationship,relatedEntities,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$1(entityName,entityId,relationship,relatedEntities),'Execute',callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endDisassociate=function(asyncState){var $0=asyncState;if($0.childNodes!=null){}else{throw asyncState;}}
SparkleXrm.Sdk.OrganizationServiceProxy.$1=function($p0,$p1,$p2,$p3){var $0='';var $enum1=ss.IEnumerator.getEnumerator($p3);while($enum1.moveNext()){var $2=$enum1.current;$0+=$2.toSoap('a');}var $1='<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">';$1+='      <request i:type="a:DisassociateRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">';$1+='        <a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">';$1+='          <a:KeyValuePairOfstringanyType>';$1+='            <b:key>Target</b:key>';$1+='            <b:value i:type="a:EntityReference">';$1+='              <a:Id>'+$p1.value+'</a:Id>';$1+='              <a:LogicalName>'+$p0+'</a:LogicalName>';$1+='              <a:Name i:nil="true" />';$1+='            </b:value>';$1+='          </a:KeyValuePairOfstringanyType>';$1+='          <a:KeyValuePairOfstringanyType>';$1+='            <b:key>Relationship</b:key>';$1+='            <b:value i:type="a:Relationship">';$1+='              <a:PrimaryEntityRole i:nil="true" />';$1+='              <a:SchemaName>'+$p2.schemaName+'</a:SchemaName>';$1+='            </b:value>';$1+='          </a:KeyValuePairOfstringanyType>';$1+='          <a:KeyValuePairOfstringanyType>';$1+='            <b:key>RelatedEntities</b:key>';$1+='            <b:value i:type="a:EntityReferenceCollection">'+$0+'</b:value>';$1+='          </a:KeyValuePairOfstringanyType>';$1+='        </a:Parameters>';$1+='        <a:RequestId i:nil="true" />';$1+='        <a:RequestName>Disassociate</a:RequestName>';$1+='      </request>';$1+='    </Execute>';return $1;}
SparkleXrm.Sdk.OrganizationServiceProxy.retrieveMultiple=function(fetchXml){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$2(fetchXml),'RetrieveMultiple',null);var $1=SparkleXrm.Sdk.OrganizationServiceProxy.$3($0,SparkleXrm.Sdk.Entity);delete $0;$0=null;return $1;}
SparkleXrm.Sdk.OrganizationServiceProxy.$2=function($p0){var $0='<RetrieveMultiple xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" ><query i:type="a:FetchExpression" ><a:Query>';$0+=SparkleXrm.Sdk.XmlHelper.encode($p0);$0+='</a:Query></query></RetrieveMultiple>';return $0;}
SparkleXrm.Sdk.OrganizationServiceProxy.beginRetrieveMultiple=function(fetchXml,callBack){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$2(fetchXml),'RetrieveMultiple',callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endRetrieveMultiple=function(asyncState,entityType){var $0=asyncState;if($0.childNodes!=null){var $1=SparkleXrm.Sdk.OrganizationServiceProxy.$3($0,entityType);return $1;}else{throw asyncState;}}
SparkleXrm.Sdk.OrganizationServiceProxy.$3=function($p0,$p1){var $0=$p0.firstChild.firstChild;var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep($0,'RetrieveMultipleResult');var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'Entities');var $3=0;if($2!=null){$3=$2.childNodes.length;}var $4=[];for(var $6=0;$6<$3;$6++){var $7=$2.childNodes[$6];var $8=new $p1(null);$8.deSerialise($7);$4[$6]=$8;}var $5=new SparkleXrm.Sdk.EntityCollection($4);$5.set_moreRecords(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($1,'MoreRecords')==='true');$5.set_pagingCookie(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($1,'PagingCookie'));$5.set_totalRecordCount(parseInt(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($1,'TotalRecordCount')));$5.set_totalRecordCountLimitExceeded(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($1,'TotalRecordCountLimitExceeded')==='true');return $5;}
SparkleXrm.Sdk.OrganizationServiceProxy.retrieve=function(entityName,entityId,attributesList){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$4(entityName,entityId,attributesList),'Retrieve',null);var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep($0,'RetrieveResult');var $2=new SparkleXrm.Sdk.Entity(entityName);$2.deSerialise($1);delete $0;$0=null;return $2;}
SparkleXrm.Sdk.OrganizationServiceProxy.beginRetrieve=function(entityName,entityId,attributesList,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$4(entityName,entityId,attributesList),'Retrieve',callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endRetrieve=function(asyncState,entityType){var $0=asyncState;var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep($0,'RetrieveResult');var $2=new SparkleXrm.Sdk.Entity(null);$2.deSerialise($1);return $2;}
SparkleXrm.Sdk.OrganizationServiceProxy.$4=function($p0,$p1,$p2){var $0='<Retrieve xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">';$0+='<entityName>'+$p0+'</entityName>';$0+='<id>'+$p1+'</id>';$0+='<columnSet xmlns:d4p1="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">';if(($p2!=null)&&($p2[0]!=='AllColumns')){$0+='<d4p1:AllColumns>false</d4p1:AllColumns>';$0+='<d4p1:Columns xmlns:d5p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays">';for(var $1=0;$1<$p2.length;$1++){$0+='<d5p1:string>'+$p2[$1]+'</d5p1:string>';}$0+='</d4p1:Columns>';}else{$0+='<d4p1:AllColumns>true</d4p1:AllColumns>';}$0+='</columnSet></Retrieve>';return $0;}
SparkleXrm.Sdk.OrganizationServiceProxy.create=function(entity){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$5(entity),'Create',null);var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValueDeep($0,'CreateResult');delete $0;$0=null;return new SparkleXrm.Sdk.Guid($1);}
SparkleXrm.Sdk.OrganizationServiceProxy.$5=function($p0){var $0='<Create xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" ><entity>';$0+=$p0.serialise(true);$0+='</entity></Create>';return $0;}
SparkleXrm.Sdk.OrganizationServiceProxy.beginCreate=function(entity,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$5(entity),'Create',callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endCreate=function(asyncState){var $0=asyncState;if($0.childNodes!=null){var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValueDeep($0,'CreateResult');return new SparkleXrm.Sdk.Guid($1);}else{throw asyncState;}}
SparkleXrm.Sdk.OrganizationServiceProxy.setState=function(id,entityName,stateCode,statusCode){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$6(id,entityName,stateCode,statusCode),'Execute',null);delete $0;$0=null;}
SparkleXrm.Sdk.OrganizationServiceProxy.beginSetState=function(id,entityName,stateCode,statusCode,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$6(id,entityName,stateCode,statusCode),'Execute',callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endSetState=function(asyncState){var $0=asyncState;if($0.childNodes!=null){}else{throw asyncState;}}
SparkleXrm.Sdk.OrganizationServiceProxy.$6=function($p0,$p1,$p2,$p3){return String.format('<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">'+'<request i:type="b:SetStateRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">'+'<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'<a:KeyValuePairOfstringanyType>'+'<c:key>EntityMoniker</c:key>'+'<c:value i:type="a:EntityReference">'+'<a:Id>{0}</a:Id>'+'<a:LogicalName>{1}</a:LogicalName>'+'<a:Name i:nil="true" />'+'</c:value>'+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<c:key>State</c:key>'+'<c:value i:type="a:OptionSetValue">'+'<a:Value>{2}</a:Value>'+'</c:value>'+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<c:key>Status</c:key>'+'<c:value i:type="a:OptionSetValue">'+'<a:Value>{3}</a:Value>'+'</c:value>'+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>SetState</a:RequestName>'+'</request></Execute>',$p0.value,$p1,$p2,$p3);}
SparkleXrm.Sdk.OrganizationServiceProxy.delete_=function(entityName,id){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$7(entityName,id),'Delete',null);var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValueDeep($0,'DeleteResult');delete $0;$0=null;return $1;}
SparkleXrm.Sdk.OrganizationServiceProxy.$7=function($p0,$p1){var $0=String.format('<Delete xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" ><entityName>{0}</entityName><id>{1}</id></Delete>',$p0,$p1.value);return $0;}
SparkleXrm.Sdk.OrganizationServiceProxy.beginDelete=function(entityName,id,callBack){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$7(entityName,id),'Delete',callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endDelete=function(asyncState){var $0=asyncState;if($0.childNodes!=null){return;}else{throw asyncState;}}
SparkleXrm.Sdk.OrganizationServiceProxy.update=function(entity){var $0='<Update xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" ><entity>';$0+=entity.serialise(true);$0+='</entity></Update>';var $1=SparkleXrm.Sdk.OrganizationServiceProxy.$B($0,'Update',null);delete $1;$1=null;}
SparkleXrm.Sdk.OrganizationServiceProxy.beginUpdate=function(entity,callBack){var $0='<Update xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" ><entity>';$0+=entity.serialise(true);$0+='</entity></Update>';var $1=SparkleXrm.Sdk.OrganizationServiceProxy.$B($0,'Update',callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endUpdate=function(asyncState){var $0=asyncState;if($0.childNodes!=null){return;}else{throw asyncState;}}
SparkleXrm.Sdk.OrganizationServiceProxy.execute=function(request){var $0=SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$8(request),'Execute',null);return SparkleXrm.Sdk.OrganizationServiceProxy.endExecute($0);}
SparkleXrm.Sdk.OrganizationServiceProxy.$8=function($p0){var $0='<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services">';$0+=$p0.serialise();$0+='</Execute>';return $0;}
SparkleXrm.Sdk.OrganizationServiceProxy.beginExecute=function(request,callBack){SparkleXrm.Sdk.OrganizationServiceProxy.$B(SparkleXrm.Sdk.OrganizationServiceProxy.$8(request),'Execute',callBack);}
SparkleXrm.Sdk.OrganizationServiceProxy.endExecute=function(asyncState){var $0=asyncState;if($0.childNodes!=null){var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep($0,'ExecuteResult');var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($1,'ResponseName');switch($2){case 'RetrieveAttribute':return new SparkleXrm.Sdk.Messages.RetrieveAttributeResponse($1);case 'RetrieveAllEntities':return new SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse($1);case 'RetrieveEntity':return new SparkleXrm.Sdk.Messages.RetrieveEntityResponse($1);case 'BulkDeleteResponse':return new SparkleXrm.Sdk.Messages.BulkDeleteResponse($1);case 'FetchXmlToQueryExpression':return new SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse($1);case 'RetrieveMetadataChanges':return new SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse($1);case 'RetrieveRelationship':return new SparkleXrm.Sdk.RetrieveRelationshipResponse($1);case 'ExecuteWorkflow':return new SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse($1);case 'Assign':return new SparkleXrm.Sdk.Messages.AssignResponse($1);default:if(Object.keyExists(SparkleXrm.Sdk.OrganizationServiceProxy.executeMessageResponseTypes,$2)){var $3=SparkleXrm.Sdk.OrganizationServiceProxy.executeMessageResponseTypes[$2];var $4=new $3($1);return $4;}else{return null;}}}else{throw asyncState;}}
SparkleXrm.Sdk.OrganizationServiceProxy.$9=function($p0){var $0='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" xmlns:d="http://schemas.microsoft.com/xrm/2011/Contracts/Services"  xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'<s:Body>'+$p0+'</s:Body>'+'</s:Envelope>';return $0;}
SparkleXrm.Sdk.OrganizationServiceProxy.$A=function(){if(typeof(Xrm.Page.context.getClientUrl)==='undefined'){var $0=Xrm.Page.context;var $1;if($0.isOutlookClient()&&!$0.isOutlookOnline()){$1=window.location.protocol+'//'+window.location.hostname;}else{$1=Xrm.Page.context.getServerUrl();$1=$1.replace(new RegExp('/^(http|https):\\/\\/([_a-zA-Z0-9\\-\\.]+)(:([0-9]{1,5}))?/'),window.location.protocol+'//'+window.location.hostname);$1=$1.replace(new RegExp('/\\/$/'),'');}return $1;}else{return Xrm.Page.context.getClientUrl();}}
SparkleXrm.Sdk.OrganizationServiceProxy.$B=function($p0,$p1,$p2){var $0=($p2!=null);var $1=SparkleXrm.Sdk.OrganizationServiceProxy.$9($p0);var $2=null;var $3=new XMLHttpRequest();$3.open('POST',SparkleXrm.Sdk.OrganizationServiceProxy.$A()+'/XRMServices/2011/Organization.svc/web',$0);$3.setRequestHeader('SOAPAction','http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/'+$p1);$3.setRequestHeader('Content-Type','text/xml; charset=utf-8');if(SparkleXrm.Sdk.OrganizationServiceProxy.withCredentials){$3.withCredentials = true;;}if($0){$3.onreadystatechange=function(){
if($3==null){return;}if($3.readyState===4){var $1_0=$3.responseXML;var $1_1=null;if($3.status!==200){$1_1=SparkleXrm.Sdk.OrganizationServiceProxy.$C($1_0);}delete $3;$3=null;if($1_1!=null){$p2($1_1);}else{$p2($1_0);}}};$3.send($1);return null;}else{$3.send($1);var $4=$3.responseXML;if($3.status!==200){$2=SparkleXrm.Sdk.OrganizationServiceProxy.$C($4);}delete $3;;$3=null;if($2!=null){throw $2;}else{return $4;}}}
SparkleXrm.Sdk.OrganizationServiceProxy.$C=function($p0){var $0=null;var $1=null;var $2=null;if($p0==null||$p0.firstChild.nodeName!=='s:Envelope'){return new Error('No SOAP Envelope in response');}var $3=$p0.firstChild.firstChild;var $4=SparkleXrm.Sdk.XmlHelper.selectSingleNode($3,'Fault');if($4!=null){var $6=SparkleXrm.Sdk.XmlHelper.selectSingleNode($4,'detail');if($6!=null){var $7=SparkleXrm.Sdk.XmlHelper.selectSingleNode($6,'OrganizationServiceFault');if($7!=null){$0=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($7,'Message');$1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($7,'TraceText');$2=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue($7,'ErrorCode');}}if($0==null){var $8=SparkleXrm.Sdk.XmlHelper.selectSingleNode($4,'faultstring');if($8!=null){$0=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($8);}}}var $5={};$5['Trace']=$1;$5['ErrorCode']=$2;return Error.createError($0,$5);}
SparkleXrm.Sdk.Relationship=function(schemaName){this.schemaName=schemaName;}
SparkleXrm.Sdk.Relationship.prototype={primaryEntityRole:0,schemaName:null}
SparkleXrm.Sdk.RetrieveRelationshipRequest=function(){this.metadataId=SparkleXrm.Sdk.Guid.empty;}
SparkleXrm.Sdk.RetrieveRelationshipRequest.prototype={name:null,retrieveAsIfPublished:false,serialise:function(){return '<request i:type="a:RetrieveRelationshipRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">'+'<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'<a:KeyValuePairOfstringanyType>'+'<b:key>MetadataId</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.metadataId,null)+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>Name</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.name,null)+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>RetrieveAsIfPublished</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.retrieveAsIfPublished,null)+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>RetrieveRelationship</a:RequestName>'+'</request>';}}
SparkleXrm.Sdk.RetrieveRelationshipResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='RelationshipMetadata'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.relationshipMetadata=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseRelationshipMetadata($3);}}}
SparkleXrm.Sdk.RetrieveRelationshipResponse.prototype={relationshipMetadata:null}
SparkleXrm.Sdk.XmlHelper=function(){}
SparkleXrm.Sdk.XmlHelper.encode=function(value){if(value==null){return value;}return value.replace(new RegExp("([\\&\"<>'])",'g'),SparkleXrm.Sdk.XmlHelper.replaceCallBackEncode);}
SparkleXrm.Sdk.XmlHelper.serialiseNode=function(node){if(typeof(node.xml)==='undefined'){return new XMLSerializer().serializeToString(node);}else{return node.xml;}}
SparkleXrm.Sdk.XmlHelper.Decode=function(value){if(value==null){return null;}return value.replace(new RegExp('(&quot;|&lt;|&gt;|&amp;|&#39;)','g'),SparkleXrm.Sdk.XmlHelper.replaceCallBackDecode);}
SparkleXrm.Sdk.XmlHelper.replaceCallBackEncode=function(item){return SparkleXrm.Sdk.XmlHelper._encode_map[item];}
SparkleXrm.Sdk.XmlHelper.replaceCallBackDecode=function(item){return SparkleXrm.Sdk.XmlHelper._decode_map[item];}
SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue=function(doc,baseName){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(doc,baseName);if($0!=null){return SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);}else{return null;}}
SparkleXrm.Sdk.XmlHelper.selectSingleNode=function(doc,baseName){var $enum1=ss.IEnumerator.getEnumerator(doc.childNodes);while($enum1.moveNext()){var $0=$enum1.current;if(SparkleXrm.Sdk.XmlHelper.getLocalName($0)===baseName){return $0;}}return null;}
SparkleXrm.Sdk.XmlHelper.getLocalName=function(node){if(node.baseName!=null){return node.baseName;}else{return node.localName;}}
SparkleXrm.Sdk.XmlHelper.selectSingleNodeValueDeep=function(doc,baseName){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep(doc,baseName);if($0!=null){return SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);}else{return null;}}
SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep=function(doc,baseName){var $enum1=ss.IEnumerator.getEnumerator(doc.childNodes);while($enum1.moveNext()){var $0=$enum1.current;if(SparkleXrm.Sdk.XmlHelper.getLocalName($0)===baseName){return $0;}var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNodeDeep($0,baseName);if($1!=null){return $1;}}return null;}
SparkleXrm.Sdk.XmlHelper.nsResolver=function(prefix){switch(prefix){case 's':return 'http://schemas.xmlsoap.org/soap/envelope/';case 'a':return 'http://schemas.microsoft.com/xrm/2011/Contracts';case 'i':return 'http://www.w3.org/2001/XMLSchema-instance';case 'b':return 'http://schemas.datacontract.org/2004/07/System.Collections.Generic';case 'c':return 'http://schemas.microsoft.com/xrm/2011/Metadata';default:return null;}}
SparkleXrm.Sdk.XmlHelper.isSelectSingleNodeUndefined=function(value){return typeof (value.selectSingleNode)==='undefined';}
SparkleXrm.Sdk.XmlHelper.loadXml=function(xml){if(typeof (ActiveXObject)==='undefined'){var $0=new DOMParser();return $0.parseFromString(xml,'text/xml');}else{var $1=(new ActiveXObject('Msxml2.DOMDocument'));$1.async = false;$1.loadXML(xml);$1.setProperty('SelectionLanguage', 'XPath');return $1;}}
SparkleXrm.Sdk.XmlHelper.selectSingleNodeXpath=function(node,xpath){if(!SparkleXrm.Sdk.XmlHelper.isSelectSingleNodeUndefined(node)){return node.selectSingleNode(xpath);}else{var $0=new XPathEvaluator();var $1=$0.evaluate(xpath,node,SparkleXrm.Sdk.XmlHelper.nsResolver,9,null);return ($1!=null)?$1.singleNodeValue:null;}}
SparkleXrm.Sdk.XmlHelper.getNodeTextValue=function(node){if((node!=null)&&(node.firstChild!=null)){return node.firstChild.nodeValue;}else{return null;}}
SparkleXrm.Sdk.XmlHelper.getAttributeValue=function(node,attributeName){var $0=node.attributes.getNamedItem(attributeName);if($0!=null){return $0.nodeValue;}else{return null;}}
Type.registerNamespace('SparkleXrm.Sdk.Messages');SparkleXrm.Sdk.Messages.EntityFilters=function(){};SparkleXrm.Sdk.Messages.EntityFilters.prototype = {default_:1,entity:1,attributes:2,privileges:4,relationships:8,all:15}
SparkleXrm.Sdk.Messages.EntityFilters.registerEnum('SparkleXrm.Sdk.Messages.EntityFilters',true);SparkleXrm.Sdk.Messages.AssignRequest=function(){}
SparkleXrm.Sdk.Messages.AssignRequest.prototype={target:null,assignee:null,serialise:function(){return '<request i:type="c:AssignRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:c="http://schemas.microsoft.com/crm/2011/Contracts">'+'        <a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'          <a:KeyValuePairOfstringanyType>'+'            <b:key>Target</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.target,null)+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <b:key>Assignee</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.assignee,null)+'          </a:KeyValuePairOfstringanyType>'+'        </a:Parameters>'+'        <a:RequestId i:nil="true" />'+'        <a:RequestName>Assign</a:RequestName>'+'      </request>';}}
SparkleXrm.Sdk.Messages.AssignResponse=function(response){}
SparkleXrm.Sdk.Messages.BulkDeleteRequest=function(){}
SparkleXrm.Sdk.Messages.BulkDeleteRequest.prototype={serialise:function(){var $0='';if(this.toRecipients!=null){var $enum1=ss.IEnumerator.getEnumerator(this.toRecipients);while($enum1.moveNext()){var $2=$enum1.current;$0+=('<d:guid>'+$2.toString()+'</d:guid>');}}var $1='';if(this.ccRecipients!=null){var $enum2=ss.IEnumerator.getEnumerator(this.ccRecipients);while($enum2.moveNext()){var $3=$enum2.current;$1+=('<d:guid>'+$3.toString()+'</d:guid>');}}return String.format('<request i:type="b:BulkDeleteRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">'+'        <a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>QuerySet</c:key>'+'            <c:value i:type="a:ArrayOfQueryExpression">'+'              <a:QueryExpression>'+this.querySet+'              </a:QueryExpression>'+'            </c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>JobName</c:key>'+'            <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">'+this.jobName+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>SendEmailNotification</c:key>'+'            <c:value i:type="d:boolean" xmlns:d="http://www.w3.org/2001/XMLSchema">'+this.sendEmailNotification.toString()+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>ToRecipients</c:key>'+'            <c:value i:type="d:ArrayOfguid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays">'+$0+'            </c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>CCRecipients</c:key>'+'            <c:value i:type="d:ArrayOfguid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/Arrays">'+$1+'            </c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>RecurrencePattern</c:key>'+'            <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema" >'+this.recurrencePattern+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>StartDateTime</c:key>'+'            <c:value i:type="d:dateTime" xmlns:d="http://www.w3.org/2001/XMLSchema">'+SparkleXrm.Sdk.DateTimeEx.toXrmStringUTC(SparkleXrm.Sdk.DateTimeEx.localTimeToUTCFromSettings(this.startDateTime,SparkleXrm.Sdk.OrganizationServiceProxy.getUserSettings()))+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'        </a:Parameters>'+'        <a:RequestId i:nil="true" />'+'        <a:RequestName>BulkDelete</a:RequestName>'+'      </request>');},ccRecipients:null,jobName:null,querySet:null,recurrencePattern:null,sendEmailNotification:false,sourceImportId:null,startDateTime:null,toRecipients:null}
SparkleXrm.Sdk.Messages.BulkDeleteResponse=function(response){}
SparkleXrm.Sdk.Messages.ExecuteWorkflowRequest=function(){}
SparkleXrm.Sdk.Messages.ExecuteWorkflowRequest.prototype={entityId:null,workflowId:null,serialise:function(){return String.format('<request i:type="b:ExecuteWorkflowRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">'+'        <a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>EntityId</c:key>'+'            <c:value i:type="e:guid" xmlns:e="http://schemas.microsoft.com/2003/10/Serialization/">'+this.entityId+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'          <a:KeyValuePairOfstringanyType>'+'            <c:key>WorkflowId</c:key>'+'            <c:value i:type="e:guid" xmlns:e="http://schemas.microsoft.com/2003/10/Serialization/">'+this.workflowId+'</c:value>'+'          </a:KeyValuePairOfstringanyType>'+'        </a:Parameters>'+'        <a:RequestId i:nil="true" />'+'        <a:RequestName>ExecuteWorkflow</a:RequestName>'+'      </request>');}}
SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='Id'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.id=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($3);}}}
SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse.prototype={id:null}
SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionRequest=function(){}
SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionRequest.prototype={fetchXml:null,serialise:function(){var $0='';$0+='      <request i:type="b:FetchXmlToQueryExpressionRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts">';$0+='        <a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">';$0+='          <a:KeyValuePairOfstringanyType>';$0+='            <c:key>FetchXml</c:key>';$0+='            <c:value i:type="d:string" xmlns:d="http://www.w3.org/2001/XMLSchema">{0}</c:value>';$0+='          </a:KeyValuePairOfstringanyType>';$0+='        </a:Parameters>';$0+='        <a:RequestId i:nil="true" />';$0+='        <a:RequestName>FetchXmlToQueryExpression</a:RequestName>';$0+='      </request>';return String.format($0,SparkleXrm.Sdk.XmlHelper.encode(this.fetchXml));}}
SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='Query'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');var $4=SparkleXrm.Sdk.XmlHelper.serialiseNode($3).substr(165);$4=$4.substr(0,$4.length-10);this.query=$4;}}}
SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse.prototype={query:null}
SparkleXrm.Sdk.Messages.RetrieveAllEntitiesRequest=function(){}
SparkleXrm.Sdk.Messages.RetrieveAllEntitiesRequest.prototype={serialise:function(){return '\r\n                              <request i:type="a:RetrieveAllEntitiesRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">\r\n                                <a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">\r\n                                  <a:KeyValuePairOfstringanyType>\r\n                                    <b:key>EntityFilters</b:key>\r\n                                    <b:value i:type="c:EntityFilters" xmlns:c="http://schemas.microsoft.com/xrm/2011/Metadata">Entity</b:value>\r\n                                  </a:KeyValuePairOfstringanyType>\r\n                                  <a:KeyValuePairOfstringanyType>\r\n                                    <b:key>RetrieveAsIfPublished</b:key>\r\n                                    <b:value i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">true</b:value>\r\n                                  </a:KeyValuePairOfstringanyType>\r\n                                </a:Parameters>\r\n                                <a:RequestId i:nil="true" />\r\n                                <a:RequestName>RetrieveAllEntities</a:RequestName>\r\n                              </request>\r\n                            ';}}
SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='EntityMetadata'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.entityMetadata=new Array($3.childNodes.length);for(var $4=0;$4<$3.childNodes.length;$4++){var $5=$3.childNodes[$4];var $6=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseEntityMetadata({},$5);this.entityMetadata[$4]=$6;}}}}
SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse.prototype={entityMetadata:null}
SparkleXrm.Sdk.Messages.RetrieveAttributeRequest=function(){}
SparkleXrm.Sdk.Messages.RetrieveAttributeRequest.prototype={entityLogicalName:null,logicalName:null,retrieveAsIfPublished:false,serialise:function(){return String.format('<request i:type="a:RetrieveAttributeRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">'+'<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'<a:KeyValuePairOfstringanyType>'+'<b:key>EntityLogicalName</b:key>'+'<b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">{0}</b:value>'+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>MetadataId</b:key>'+'<b:value i:type="ser:guid"  xmlns:ser="http://schemas.microsoft.com/2003/10/Serialization/">00000000-0000-0000-0000-000000000000</b:value>'+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>RetrieveAsIfPublished</b:key>'+'<b:value i:type="c:boolean" xmlns:c="http://www.w3.org/2001/XMLSchema">{2}</b:value>'+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>LogicalName</b:key>'+'<b:value i:type="c:string" xmlns:c="http://www.w3.org/2001/XMLSchema">{1}</b:value>'+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>RetrieveAttribute</a:RequestName>'+'</request>',this.entityLogicalName,this.logicalName,this.retrieveAsIfPublished);}}
SparkleXrm.Sdk.Messages.RetrieveAttributeResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $1=SparkleXrm.Sdk.XmlHelper.selectSingleNode($0.firstChild,'value');var $2=SparkleXrm.Sdk.XmlHelper.getAttributeValue($1,'i:type');switch($2){case 'c:PicklistAttributeMetadata':this.attributeMetadata=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialisePicklistAttributeMetadata({},$1);break;}}
SparkleXrm.Sdk.Messages.RetrieveAttributeResponse.prototype={attributeMetadata:null}
SparkleXrm.Sdk.Messages.RetrieveEntityRequest=function(){}
SparkleXrm.Sdk.Messages.RetrieveEntityRequest.prototype={entityFilters:0,logicalName:null,metadataId:null,retrieveAsIfPublished:false,serialise:function(){return '<request i:type="a:RetrieveEntityRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">'+'<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">'+'<a:KeyValuePairOfstringanyType>'+'<b:key>EntityFilters</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.entityFilters,'EntityFilters')+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>MetadataId</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.metadataId,null)+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>RetrieveAsIfPublished</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.retrieveAsIfPublished,null)+'</a:KeyValuePairOfstringanyType>'+'<a:KeyValuePairOfstringanyType>'+'<b:key>LogicalName</b:key>'+SparkleXrm.Sdk.Attribute.serialiseValue(this.logicalName,null)+'</a:KeyValuePairOfstringanyType>'+'</a:Parameters>'+'<a:RequestId i:nil="true" />'+'<a:RequestName>RetrieveEntity</a:RequestName>'+'</request>';}}
SparkleXrm.Sdk.Messages.RetrieveEntityResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');if(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)==='EntityMetadata'){var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');this.entityMetadata=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseEntityMetadata({},$3);}}}
SparkleXrm.Sdk.Messages.RetrieveEntityResponse.prototype={entityMetadata:null}
SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest=function(){}
SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest.prototype={clientVersionStamp:null,deletedMetadataFilters:null,query:null,serialise:function(){return "<request i:type='a:RetrieveMetadataChangesRequest' xmlns:a='http://schemas.microsoft.com/xrm/2011/Contracts'>\r\n                <a:Parameters xmlns:b='http://schemas.datacontract.org/2004/07/System.Collections.Generic'>\r\n                  <a:KeyValuePairOfstringanyType>\r\n                    <b:key>ClientVersionStamp</b:key>"+SparkleXrm.Sdk.Attribute.serialiseValue(this.clientVersionStamp,null)+'\r\n                  </a:KeyValuePairOfstringanyType>\r\n                  <a:KeyValuePairOfstringanyType>\r\n                    <b:key>Query</b:key>\r\n                    '+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseEntityQueryExpression(this.query)+"\r\n                  </a:KeyValuePairOfstringanyType>\r\n                </a:Parameters>\r\n                <a:RequestId i:nil='true' />\r\n                <a:RequestName>RetrieveMetadataChanges</a:RequestName>\r\n              </request>";}}
SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse=function(response){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(response,'Results');var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;var $2=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'key');var $3=SparkleXrm.Sdk.XmlHelper.selectSingleNode($1,'value');switch(SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2)){case 'ServerVersionStamp':this.serverVersionStamp=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($3);break;case 'DeletedMetadata':break;case 'EntityMetadata':this.entityMetadata=[];for(var $4=0;$4<$3.childNodes.length;$4++){var $5=$3.childNodes[$4];var $6=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseEntityMetadata({},$5);this.entityMetadata.add($6);}break;}}}
SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse.prototype={entityMetadata:null,serverVersionStamp:null}
Type.registerNamespace('SparkleXrm.Sdk.Metadata.Query');SparkleXrm.Sdk.Metadata.Query.DeletedMetadataFilters=function(){};SparkleXrm.Sdk.Metadata.Query.DeletedMetadataFilters.prototype = {default_:'default_',entity:'entity',attribute:'attribute',relationship:'relationship',label:'label',optionSet:'optionSet',all:'all'}
SparkleXrm.Sdk.Metadata.Query.DeletedMetadataFilters.registerEnum('SparkleXrm.Sdk.Metadata.Query.DeletedMetadataFilters',false);SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser=function(){}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseAttributeMetadata=function(item,attribute){var $enum1=ss.IEnumerator.getEnumerator(attribute.childNodes);while($enum1.moveNext()){var $0=$enum1.current;var $1=item;var $2=SparkleXrm.Sdk.XmlHelper.getLocalName($0);var $3=$2.substr(0,1).toLowerCase()+$2.substr(1);if($0.attributes.length===1&&$0.attributes[0].nodeName==='i:nil'){continue;}switch($2){case 'AttributeOf':case 'DeprecatedVersion':case 'EntityLogicalName':case 'LogicalName':case 'SchemaName':case 'CalculationOf':$1[$3]=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);break;case 'CanBeSecuredForCreate':case 'CanBeSecuredForRead':case 'CanBeSecuredForUpdate':case 'CanModifyAdditionalSettings':case 'IsAuditEnabled':case 'IsCustomAttribute':case 'IsCustomizable':case 'IsManaged':case 'IsPrimaryId':case 'IsPrimaryName':case 'IsRenameable':case 'IsSecured':case 'IsValidForAdvancedFind':case 'IsValidForCreate':case 'IsValidForRead':case 'IsValidForUpdate':case 'DefaultValue':$1[$3]=SparkleXrm.Sdk.Attribute.deSerialise($0,'boolean');break;case 'ColumnNumber':case 'Precision':case 'DefaultFormValue':case 'MaxLength':case 'PrecisionSource':$1[$3]=SparkleXrm.Sdk.Attribute.deSerialise($0,'int');break;case 'Description':case 'DisplayName':var $4={};$1[$3]=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLabel($4,$0);break;case 'OptionSet':var $5={};$1[$3]=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionSetMetadata($5,$0);break;case 'AttributeType':item.attributeType=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);break;}}return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseEntityMetadata=function(item,entity){var $enum1=ss.IEnumerator.getEnumerator(entity.childNodes);while($enum1.moveNext()){var $0=$enum1.current;var $1=item;var $2=SparkleXrm.Sdk.XmlHelper.getLocalName($0);var $3=$2.substr(0,1).toLowerCase()+$2.substr(1);if($0.attributes.length===1&&$0.attributes[0].nodeName==='i:nil'){continue;}switch($2){case 'IconLargeName':case 'IconMediumName':case 'IconSmallName':case 'LogicalName':case 'PrimaryIdAttribute':case 'PrimaryNameAttribute':case 'RecurrenceBaseEntityLogicalName':case 'ReportViewName':case 'SchemaName':case 'PrimaryImageAttribute':$1[$3]=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($0);break;case 'AutoRouteToOwnerQueue':case 'CanBeInManyToMany':case 'CanBePrimaryEntityInRelationship':case 'CanBeRelatedEntityInRelationship':case 'CanCreateAttributes':case 'CanCreateCharts':case 'CanCreateForms':case 'CanCreateViews':case 'CanModifyAdditionalSettings':case 'CanTriggerWorkflow':case 'IsActivity':case 'IsActivityParty':case 'IsAuditEnabled':case 'IsAvailableOffline':case 'IsChildEntity':case 'IsConnectionsEnabled':case 'IsCustomEntity':case 'IsCustomizable':case 'IsDocumentManagementEnabled':case 'IsDuplicateDetectionEnabled':case 'IsEnabledForCharts':case 'IsImportable':case 'IsIntersect':case 'IsMailMergeEnabled':case 'IsManaged':case 'IsReadingPaneEnabled':case 'IsRenameable':case 'IsValidForAdvancedFind':case 'IsValidForQueue':case 'IsVisibleInMobile':$1[$3]=SparkleXrm.Sdk.Attribute.deSerialise($0,'boolean');break;case 'ActivityTypeMask':case 'ObjectTypeCode':$1[$3]=SparkleXrm.Sdk.Attribute.deSerialise($0,'int');break;case 'Attributes':item.attributes=[];var $enum2=ss.IEnumerator.getEnumerator($0.childNodes);while($enum2.moveNext()){var $5=$enum2.current;var $6={};item.attributes.add(SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseAttributeMetadata($6,$5));}break;case 'Description':case 'DisplayCollectionName':case 'DisplayName':var $4={};$1[$3]=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLabel($4,$0);break;}}return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLabel=function(item,metaData){item.localizedLabels=[];var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'LocalizedLabels');if($0!=null&&$0.childNodes!=null){var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;item.localizedLabels.add(SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLocalizedLabel({},$1));}item.userLocalizedLabel=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLocalizedLabel({},SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'UserLocalizedLabel'));}return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLocalizedLabel=function(item,metaData){item.label=SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(metaData,'Label');item.languageCode=parseInt(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(metaData,'LanguageCode'));return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseAttributeQueryExpression=function(item){return SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataQueryExpression(item);}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseEntityQueryExpression=function(item){if(item!=null){var $0="<b:value i:type='c:EntityQueryExpression' xmlns:c='http://schemas.microsoft.com/xrm/2011/Metadata/Query'>"+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataQueryExpression(item);if(item.attributeQuery!=null){$0+='<c:AttributeQuery>'+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseAttributeQueryExpression(item.attributeQuery)+'</c:AttributeQuery>';}$0+='<c:LabelQuery>'+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseLabelQueryExpression(item.labelQuery)+"</c:LabelQuery>\r\n                <c:RelationshipQuery i:nil='true' />\r\n                </b:value>";return $0;}else{return "<b:value i:nil='true'/>";}}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseLabelQueryExpression=function(item){if(item!=null){var $0="<c:FilterLanguages xmlns:d='http://schemas.microsoft.com/2003/10/Serialization/Arrays'>";var $enum1=ss.IEnumerator.getEnumerator(item.filterLanguages);while($enum1.moveNext()){var $1=$enum1.current;$0=$0+'<d:int>'+$1.toString()+'</d:int>';}$0=$0+'</c:FilterLanguages>';return $0;}else{return '';}}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataConditionExpression=function(item){return '<c:MetadataConditionExpression>\r\n                            <c:ConditionOperator>'+item.conditionOperator+'</c:ConditionOperator>\r\n                            <c:PropertyName>'+item.propertyName+"</c:PropertyName>\r\n                            <c:Value i:type='d:string' xmlns:d='http://www.w3.org/2001/XMLSchema'>"+item.value+'</c:Value>\r\n                          </c:MetadataConditionExpression>';}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataFilterExpression=function(item){if(item!=null){var $0='<c:Conditions>';var $enum1=ss.IEnumerator.getEnumerator(item.conditions);while($enum1.moveNext()){var $1=$enum1.current;$0+=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataConditionExpression($1);}$0=$0+'</c:Conditions>\r\n                        <c:FilterOperator>'+item.filterOperator+'</c:FilterOperator>\r\n                        <c:Filters />';return $0;}return '';}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataPropertiesExpression=function(item){if(item!=null){var $0='\r\n                <c:AllProperties>'+((item.allProperties!=null)?item.allProperties.toString().toLowerCase():'false')+"</c:AllProperties>\r\n                <c:PropertyNames xmlns:d='http://schemas.microsoft.com/2003/10/Serialization/Arrays'>";if(item.propertyNames!=null){var $enum1=ss.IEnumerator.getEnumerator(item.propertyNames);while($enum1.moveNext()){var $1=$enum1.current;$0=$0+'<d:string>'+$1+'</d:string>';}}$0=$0+'\r\n                </c:PropertyNames>\r\n              ';return $0;}return '';}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataQueryExpression=function(item){if(item!=null){var $0='<c:Criteria>'+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataFilterExpression(item.criteria)+'</c:Criteria>\r\n                    <c:Properties>'+SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.serialiseMetadataPropertiesExpression(item.properties)+' </c:Properties>';return $0;}return '';}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseRelationshipMetadata=function(attribute){var $0;var $1=SparkleXrm.Sdk.XmlHelper.getAttributeValue(attribute,'i:type');switch($1){case 'c:OneToManyRelationshipMetadata':$0={};break;case 'c:ManyToManyRelationshipMetadata':$0={};break;default:throw new Error('Unknown relationship type');}var $enum1=ss.IEnumerator.getEnumerator(attribute.childNodes);while($enum1.moveNext()){var $2=$enum1.current;var $3=$0;var $4=SparkleXrm.Sdk.XmlHelper.getLocalName($2);var $5=$4.substr(0,1).toLowerCase()+$4.substr(1);if($2.attributes.length===1&&$2.attributes[0].nodeName==='i:nil'){continue;}switch($4){case 'SchemaName':case 'ReferencedAttribute':case 'ReferencedEntity':case 'ReferencingAttribute':case 'ReferencingEntity':case 'Entity1IntersectAttribute':case 'Entity1LogicalName':case 'Entity2IntersectAttribute':case 'Entity2LogicalName':case 'IntersectEntityName':$3[$5]=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2);break;case 'IsCustomRelationship':case 'IsManaged':case 'IsValidForAdvancedFind':$3[$5]=SparkleXrm.Sdk.Attribute.deSerialise($2,'boolean');break;case 'RelationshipType':$3[$5]=SparkleXrm.Sdk.XmlHelper.getNodeTextValue($2);break;}}return $0;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionMetadata=function(item,metaData){item.value=parseInt(SparkleXrm.Sdk.XmlHelper.selectSingleNodeValue(metaData,'Value'));item.label=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseLabel({},SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'Label'));return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionSetMetadata=function(item,metaData){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'Options');if($0!=null){item.options=[];var $enum1=ss.IEnumerator.getEnumerator($0.childNodes);while($enum1.moveNext()){var $1=$enum1.current;item.options.add(SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionMetadata({},$1));}}return item;}
SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialisePicklistAttributeMetadata=function(item,metaData){var $0=SparkleXrm.Sdk.XmlHelper.selectSingleNode(metaData,'OptionSet');if($0!=null){item.optionSet=SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.deSerialiseOptionSetMetadata({},$0);}return item;}
Type.registerNamespace('SparkleXrm.Sdk.Metadata');SparkleXrm.Sdk.Metadata.AttributeRequiredLevel=function(){};SparkleXrm.Sdk.Metadata.AttributeRequiredLevel.prototype = {None:'None',SystemRequired:'SystemRequired',ApplicationRequired:'ApplicationRequired',Recommended:'Recommended'}
SparkleXrm.Sdk.Metadata.AttributeRequiredLevel.registerEnum('SparkleXrm.Sdk.Metadata.AttributeRequiredLevel',false);SparkleXrm.Sdk.Metadata.AttributeTypeCode=function(){};SparkleXrm.Sdk.Metadata.AttributeTypeCode.prototype = {Boolean:'Boolean',Customer:'Customer',DateTime:'DateTime',Decimal:'Decimal',Double:'Double',Integer:'Integer',Lookup:'Lookup',Memo:'Memo',None:'None',Owner:'Owner',PartyList:'PartyList',Picklist:'Picklist',State:'State',Status:'Status',String:'String',Uniqueidentifier:'Uniqueidentifier',CalendarRules:'CalendarRules',Virtual:'Virtual',BigInt:'BigInt',ManagedProperty:'ManagedProperty',EntityName:'EntityName'}
SparkleXrm.Sdk.Metadata.AttributeTypeCode.registerEnum('SparkleXrm.Sdk.Metadata.AttributeTypeCode',false);SparkleXrm.Sdk.Metadata.DateTimeFormat=function(){};SparkleXrm.Sdk.Metadata.DateTimeFormat.prototype = {DateOnly:'DateOnly',DateAndTime:'DateAndTime'}
SparkleXrm.Sdk.Metadata.DateTimeFormat.registerEnum('SparkleXrm.Sdk.Metadata.DateTimeFormat',false);SparkleXrm.Sdk.Metadata.IntegerFormat=function(){};SparkleXrm.Sdk.Metadata.IntegerFormat.prototype = {None:'None',Duration:'Duration',TimeZone:'TimeZone',Language:'Language',Locale:'Locale'}
SparkleXrm.Sdk.Metadata.IntegerFormat.registerEnum('SparkleXrm.Sdk.Metadata.IntegerFormat',false);SparkleXrm.Sdk.Metadata.OptionSetType=function(){};SparkleXrm.Sdk.Metadata.OptionSetType.prototype = {Picklist:'Picklist',State:'State',Status:'Status',Boolean:'Boolean'}
SparkleXrm.Sdk.Metadata.OptionSetType.registerEnum('SparkleXrm.Sdk.Metadata.OptionSetType',false);SparkleXrm.Sdk.Metadata.RelationshipType=function(){};SparkleXrm.Sdk.Metadata.RelationshipType.prototype = {OneToManyRelationship:'OneToManyRelationship',Default:'Default',ManyToManyRelationship:'ManyToManyRelationship'}
SparkleXrm.Sdk.Metadata.RelationshipType.registerEnum('SparkleXrm.Sdk.Metadata.RelationshipType',false);SparkleXrm.Sdk.Metadata.StringFormat=function(){};SparkleXrm.Sdk.Metadata.StringFormat.prototype = {Email:'Email',Text:'Text',TextArea:'TextArea',Url:'Url',TickerSymbol:'TickerSymbol',PhoneticGuide:'PhoneticGuide',VersionNumber:'VersionNumber',Phone:'Phone'}
SparkleXrm.Sdk.Metadata.StringFormat.registerEnum('SparkleXrm.Sdk.Metadata.StringFormat',false);SparkleXrm.Sdk.Metadata.MetadataCache=function(){}
SparkleXrm.Sdk.Metadata.MetadataCache.get_entityMetaData=function(){return SparkleXrm.Sdk.Metadata.MetadataCache.$1;}
SparkleXrm.Sdk.Metadata.MetadataCache.get_attributeMetaData=function(){return SparkleXrm.Sdk.Metadata.MetadataCache.$0;}
SparkleXrm.Sdk.Metadata.MetadataCache.get_optionsetMetaData=function(){return SparkleXrm.Sdk.Metadata.MetadataCache.$2;}
SparkleXrm.Sdk.Metadata.MetadataCache.getOptionSetValues=function(entityLogicalName,attributeLogicalName,allowEmpty){if(allowEmpty==null){allowEmpty=false;}var $0=entityLogicalName+'.'+attributeLogicalName+'.'+allowEmpty.toString();if(Object.keyExists(SparkleXrm.Sdk.Metadata.MetadataCache.$2,$0)){return SparkleXrm.Sdk.Metadata.MetadataCache.$2[$0];}else{var $1=SparkleXrm.Sdk.Metadata.MetadataCache.$4(entityLogicalName,attributeLogicalName);var $2=$1;var $3=[];if(allowEmpty){$3.add({});}var $enum1=ss.IEnumerator.getEnumerator($2.optionSet.options);while($enum1.moveNext()){var $4=$enum1.current;var $5={};$5.name=$4.label.userLocalizedLabel.label;$5.value=$4.value;$3.add($5);}SparkleXrm.Sdk.Metadata.MetadataCache.$2[$0]=$3;return $3;}}
SparkleXrm.Sdk.Metadata.MetadataCache.getEntityTypeCodeFromName=function(typeName){var $0=SparkleXrm.Sdk.Metadata.MetadataCache.$3(typeName);return $0.objectTypeCode;}
SparkleXrm.Sdk.Metadata.MetadataCache.getSmallIconUrl=function(typeName){var $0=SparkleXrm.Sdk.Metadata.MetadataCache.$3(typeName);if($0.isCustomEntity!=null&&!!$0.isCustomEntity){if($0.iconSmallName!=null){return '../../'+$0.iconSmallName;}else{return '../../../../_Common/icon.aspx?cache=1&iconType=NavigationIcon&objectTypeCode='+$0.objectTypeCode.toString();}}else{return '/_imgs/ico_16_'+$0.objectTypeCode.toString()+'.gif';}}
SparkleXrm.Sdk.Metadata.MetadataCache.$3=function($p0){var $0=$p0;var $1=SparkleXrm.Sdk.Metadata.MetadataCache.$1[$0];if($1==null){var $2=new SparkleXrm.Sdk.Messages.RetrieveEntityRequest();$2.entityFilters=1;$2.logicalName=$p0;$2.retrieveAsIfPublished=true;$2.metadataId=new SparkleXrm.Sdk.Guid('00000000-0000-0000-0000-000000000000');var $3=SparkleXrm.Sdk.OrganizationServiceProxy.execute($2);$1=$3.entityMetadata;SparkleXrm.Sdk.Metadata.MetadataCache.$1[$0]=$1;}return $1;}
SparkleXrm.Sdk.Metadata.MetadataCache.$4=function($p0,$p1){var $0=$p0+'|'+$p1;var $1=SparkleXrm.Sdk.Metadata.MetadataCache.$0[$0];if($1==null){var $2=new SparkleXrm.Sdk.Messages.RetrieveAttributeRequest();$2.entityLogicalName=$p0;$2.logicalName=$p1;$2.retrieveAsIfPublished=true;var $3=SparkleXrm.Sdk.OrganizationServiceProxy.execute($2);$1=$3.attributeMetadata;SparkleXrm.Sdk.Metadata.MetadataCache.$0[$0]=$1;}return $1;}
SparkleXrm.Sdk.Metadata.MetadataCache.AddOptionsetMetadata=function(entityLogicalName,attributeLogicalName,allowEmpty,metatdata){var $0=entityLogicalName+'.'+attributeLogicalName+'.'+allowEmpty.toString();var $1=[];if(allowEmpty){$1.add({});}var $enum1=ss.IEnumerator.getEnumerator(metatdata);while($enum1.moveNext()){var $2=$enum1.current;var $3={};$3.name=$2['label'];$3.value=$2['value'];$1.add($3);}SparkleXrm.Sdk.Metadata.MetadataCache.get_optionsetMetaData()[$0]=$1;}
SparkleXrm.Sdk.Metadata.Query.MetadataConditionOperator=function(){};SparkleXrm.Sdk.Metadata.Query.MetadataConditionOperator.prototype = {Equals:'Equals',NotEquals:'NotEquals',In:'In',NotIn:'NotIn',GreaterThan:'GreaterThan',LessThan:'LessThan'}
SparkleXrm.Sdk.Metadata.Query.MetadataConditionOperator.registerEnum('SparkleXrm.Sdk.Metadata.Query.MetadataConditionOperator',false);SparkleXrm.Sdk.Metadata.Query.LogicalOperator=function(){};SparkleXrm.Sdk.Metadata.Query.LogicalOperator.prototype = {And:'And',Or:'Or'}
SparkleXrm.Sdk.Metadata.Query.LogicalOperator.registerEnum('SparkleXrm.Sdk.Metadata.Query.LogicalOperator',false);SparkleXrm.Sdk.Metadata.Query.MetadataQueryBuilder=function(){this.request=new SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest();this.request.query={};this.request.query.criteria={};this.request.query.criteria.filterOperator='Or';this.request.query.criteria.conditions=[];}
SparkleXrm.Sdk.Metadata.Query.MetadataQueryBuilder.prototype={request:null,addEntities:function(entityLogicalNames,propertiesToReturn){this.request.query.criteria={};this.request.query.criteria.filterOperator='Or';this.request.query.criteria.conditions=[];var $enum1=ss.IEnumerator.getEnumerator(entityLogicalNames);while($enum1.moveNext()){var $0=$enum1.current;var $1={};$1.conditionOperator='Equals';$1.propertyName='LogicalName';$1.value=$0;this.request.query.criteria.conditions.add($1);}this.request.query.properties={};this.request.query.properties.propertyNames=propertiesToReturn;},addAttributes:function(attributeLogicalNames,propertiesToReturn){var $0={};$0.properties={};$0.properties.propertyNames=propertiesToReturn;this.request.query.attributeQuery=$0;var $1={};$0.criteria=$1;$1.filterOperator='Or';$1.conditions=[];var $enum1=ss.IEnumerator.getEnumerator(attributeLogicalNames);while($enum1.moveNext()){var $2=$enum1.current;var $3={};$3.propertyName='LogicalName';$3.conditionOperator='Equals';$3.value=$2;$1.conditions.add($3);}},setLanguage:function(lcid){this.request.query.labelQuery={};this.request.query.labelQuery.filterLanguages=[];this.request.query.labelQuery.filterLanguages.add(lcid);}}
Type.registerNamespace('SparkleXrm.Sdk.Ribbon');SparkleXrm.Sdk.Ribbon.RibbonButton=function(Id,Sequence,LabelText,Command,Image16,Image32){SparkleXrm.Sdk.Ribbon.RibbonButton.initializeBase(this,[Id,Sequence,LabelText,Command,Image16,Image32]);}
SparkleXrm.Sdk.Ribbon.RibbonButton.prototype={serialiseToRibbonXml:function(sb){sb.appendLine('<Button Id="'+SparkleXrm.Sdk.XmlHelper.encode(this.Id)+'" LabelText="'+SparkleXrm.Sdk.XmlHelper.encode(this.LabelText)+'" Sequence="'+this.Sequence.toString()+'" Command="'+SparkleXrm.Sdk.XmlHelper.encode(this.Command)+'"'+((this.Image32by32!=null)?(' Image32by32="'+SparkleXrm.Sdk.XmlHelper.encode(this.Image32by32)+'"'):'')+((this.Image16by16!=null)?(' Image16by16="'+SparkleXrm.Sdk.XmlHelper.encode(this.Image16by16)+'"'):'')+' />');}}
SparkleXrm.Sdk.Ribbon.RibbonControl=function(Id,Sequence,LabelText,Command,Image16,Image32){this.Id=Id;this.Sequence=Sequence;this.LabelText=LabelText;this.Command=Command;this.Image16by16=Image16;this.Image32by32=Image32;}
SparkleXrm.Sdk.Ribbon.RibbonControl.prototype={Id:null,LabelText:null,Sequence:0,Command:null,Image16by16:null,Image32by32:null,serialiseToRibbonXml:function(sb){}}
SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor=function(Id,Sequence,LabelText,Command,Image16,Image32){SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor.initializeBase(this,[Id,Sequence,LabelText,Command,Image16,Image32]);}
SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor.prototype={menu:null,serialiseToRibbonXml:function(sb){sb.appendLine('<FlyoutAnchor Id="'+SparkleXrm.Sdk.XmlHelper.encode(this.Id)+'" LabelText="'+SparkleXrm.Sdk.XmlHelper.encode(this.LabelText)+'" Sequence="'+this.Sequence.toString()+'" Command="'+SparkleXrm.Sdk.XmlHelper.encode(this.Command)+'"'+((this.Image32by32!=null)?(' Image32by32="'+SparkleXrm.Sdk.XmlHelper.encode(this.Image32by32)+'"'):'')+((this.Image16by16!=null)?(' Image16by16="'+SparkleXrm.Sdk.XmlHelper.encode(this.Image16by16)+'"'):'')+' PopulateDynamically="false">');sb.appendLine(this.menu.serialiseToRibbonXml());sb.appendLine('</FlyoutAnchor>');}}
SparkleXrm.Sdk.Ribbon.RibbonMenu=function(Id){this.sections=[];this.Id=Id;}
SparkleXrm.Sdk.Ribbon.RibbonMenu.prototype={Id:null,serialiseToRibbonXml:function(){var $0=new ss.StringBuilder();$0.appendLine('<Menu Id="'+this.Id+'">');var $enum1=ss.IEnumerator.getEnumerator(this.sections);while($enum1.moveNext()){var $1=$enum1.current;$1.serialiseToRibbonXml($0);}$0.appendLine('</Menu>');return $0.toString();},addSection:function(section){SparkleXrm.ArrayEx.add(this.sections,section);return this;}}
SparkleXrm.Sdk.Ribbon.RibbonMenuSection=function(Id,LabelText,Sequence,DisplayMode){this.buttons=[];this.Id=Id;this.Title=LabelText;this.Sequence=Sequence;this.DisplayMode=DisplayMode;}
SparkleXrm.Sdk.Ribbon.RibbonMenuSection.prototype={Id:null,Title:null,Sequence:0,DisplayMode:null,serialiseToRibbonXml:function(sb){sb.appendLine('<MenuSection Id="'+SparkleXrm.Sdk.XmlHelper.encode(this.Id)+((this.Title!=null)?'" Title="'+this.Title:'')+'" Sequence="'+this.Sequence.toString()+'" DisplayMode="'+this.DisplayMode+'">');sb.appendLine('<Controls Id="'+SparkleXrm.Sdk.XmlHelper.encode(this.Id+'.Controls')+'">');var $enum1=ss.IEnumerator.getEnumerator(this.buttons);while($enum1.moveNext()){var $0=$enum1.current;$0.serialiseToRibbonXml(sb);}sb.appendLine('</Controls>');sb.appendLine('</MenuSection>');},addButton:function(button){SparkleXrm.ArrayEx.add(this.buttons,button);return this;}}
Type.registerNamespace('SparkleXrm.Services');SparkleXrm.Services.CachedOrganizationService=function(){}
SparkleXrm.Services.CachedOrganizationService.retrieve=function(entityName,entityId,attributesList){var $0=SparkleXrm.Services.CachedOrganizationService.cache.get(entityName,entityId);if($0==null){$0=SparkleXrm.Sdk.OrganizationServiceProxy.retrieve(entityName,entityId,attributesList);SparkleXrm.Services.CachedOrganizationService.cache.insert(entityName,entityId,$0);return $0;}else{return $0;}}
SparkleXrm.Services.CachedOrganizationService.retrieveMultiple=function(fetchXml){var $0=SparkleXrm.Services.CachedOrganizationService.cache.get('query',fetchXml);if($0==null){$0=SparkleXrm.Sdk.OrganizationServiceProxy.retrieveMultiple(fetchXml);SparkleXrm.Services.CachedOrganizationService.cache.insert('query',fetchXml,$0);return $0;}else{return $0;}}
SparkleXrm.Services.OrganizationServiceCache=function(){this.$0={};}
SparkleXrm.Services.OrganizationServiceCache.prototype={remove:function(entityName,id){},insert:function(key,query,results){this.$0[key+'_'+query]=results;},get:function(key,query){return this.$0[key+'_'+query];}}
SparkleXrm.ArrayEx.registerClass('SparkleXrm.ArrayEx');SparkleXrm.DelegateItterator.registerClass('SparkleXrm.DelegateItterator');SparkleXrm.NumberEx.registerClass('SparkleXrm.NumberEx');SparkleXrm.Xrm.PageEx.registerClass('SparkleXrm.Xrm.PageEx');SparkleXrm.StringEx.registerClass('SparkleXrm.StringEx');SparkleXrm.TaskIterrator.registerClass('SparkleXrm.TaskIterrator');SparkleXrm.Sdk.Attribute.registerClass('SparkleXrm.Sdk.Attribute');SparkleXrm.Sdk.AttributeTypes.registerClass('SparkleXrm.Sdk.AttributeTypes');SparkleXrm.Sdk.Entity.registerClass('SparkleXrm.Sdk.Entity',null,SparkleXrm.ComponentModel.INotifyPropertyChanged);SparkleXrm.Sdk.OrganizationSettings.registerClass('SparkleXrm.Sdk.OrganizationSettings',SparkleXrm.Sdk.Entity);SparkleXrm.Sdk.UserSettingsAttributes.registerClass('SparkleXrm.Sdk.UserSettingsAttributes');SparkleXrm.Sdk.UserSettings.registerClass('SparkleXrm.Sdk.UserSettings',SparkleXrm.Sdk.Entity);SparkleXrm.Sdk.DataCollectionOfEntity.registerClass('SparkleXrm.Sdk.DataCollectionOfEntity',null,ss.IEnumerable);SparkleXrm.Sdk.DateTimeEx.registerClass('SparkleXrm.Sdk.DateTimeEx');SparkleXrm.Sdk.EntityCollection.registerClass('SparkleXrm.Sdk.EntityCollection');SparkleXrm.Sdk.EntityReference.registerClass('SparkleXrm.Sdk.EntityReference');SparkleXrm.Sdk.Guid.registerClass('SparkleXrm.Sdk.Guid');SparkleXrm.Sdk.Money.registerClass('SparkleXrm.Sdk.Money');SparkleXrm.Sdk.OptionSetValue.registerClass('SparkleXrm.Sdk.OptionSetValue');SparkleXrm.Sdk.OrganizationServiceProxy.registerClass('SparkleXrm.Sdk.OrganizationServiceProxy');SparkleXrm.Sdk.Relationship.registerClass('SparkleXrm.Sdk.Relationship');SparkleXrm.Sdk.RetrieveRelationshipRequest.registerClass('SparkleXrm.Sdk.RetrieveRelationshipRequest',null,Object);SparkleXrm.Sdk.RetrieveRelationshipResponse.registerClass('SparkleXrm.Sdk.RetrieveRelationshipResponse',null,Object);SparkleXrm.Sdk.XmlHelper.registerClass('SparkleXrm.Sdk.XmlHelper');SparkleXrm.Sdk.Messages.AssignRequest.registerClass('SparkleXrm.Sdk.Messages.AssignRequest',null,Object);SparkleXrm.Sdk.Messages.AssignResponse.registerClass('SparkleXrm.Sdk.Messages.AssignResponse',null,Object);SparkleXrm.Sdk.Messages.BulkDeleteRequest.registerClass('SparkleXrm.Sdk.Messages.BulkDeleteRequest',null,Object);SparkleXrm.Sdk.Messages.BulkDeleteResponse.registerClass('SparkleXrm.Sdk.Messages.BulkDeleteResponse',null,Object);SparkleXrm.Sdk.Messages.ExecuteWorkflowRequest.registerClass('SparkleXrm.Sdk.Messages.ExecuteWorkflowRequest',null,Object);SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse.registerClass('SparkleXrm.Sdk.Messages.ExecuteWorkflowResponse',null,Object);SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionRequest.registerClass('SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionRequest',null,Object);SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse.registerClass('SparkleXrm.Sdk.Messages.FetchXmlToQueryExpressionResponse',null,Object);SparkleXrm.Sdk.Messages.RetrieveAllEntitiesRequest.registerClass('SparkleXrm.Sdk.Messages.RetrieveAllEntitiesRequest',null,Object);SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse.registerClass('SparkleXrm.Sdk.Messages.RetrieveAllEntitiesResponse',null,Object);SparkleXrm.Sdk.Messages.RetrieveAttributeRequest.registerClass('SparkleXrm.Sdk.Messages.RetrieveAttributeRequest',null,Object);SparkleXrm.Sdk.Messages.RetrieveAttributeResponse.registerClass('SparkleXrm.Sdk.Messages.RetrieveAttributeResponse',null,Object);SparkleXrm.Sdk.Messages.RetrieveEntityRequest.registerClass('SparkleXrm.Sdk.Messages.RetrieveEntityRequest',null,Object);SparkleXrm.Sdk.Messages.RetrieveEntityResponse.registerClass('SparkleXrm.Sdk.Messages.RetrieveEntityResponse',null,Object);SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest.registerClass('SparkleXrm.Sdk.Messages.RetrieveMetadataChangesRequest',null,Object);SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse.registerClass('SparkleXrm.Sdk.Messages.RetrieveMetadataChangesResponse',null,Object);SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser.registerClass('SparkleXrm.Sdk.Metadata.Query.MetadataSerialiser');SparkleXrm.Sdk.Metadata.MetadataCache.registerClass('SparkleXrm.Sdk.Metadata.MetadataCache');SparkleXrm.Sdk.Metadata.Query.MetadataQueryBuilder.registerClass('SparkleXrm.Sdk.Metadata.Query.MetadataQueryBuilder');SparkleXrm.Sdk.Ribbon.RibbonControl.registerClass('SparkleXrm.Sdk.Ribbon.RibbonControl');SparkleXrm.Sdk.Ribbon.RibbonButton.registerClass('SparkleXrm.Sdk.Ribbon.RibbonButton',SparkleXrm.Sdk.Ribbon.RibbonControl);SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor.registerClass('SparkleXrm.Sdk.Ribbon.RibbonFlyoutAnchor',SparkleXrm.Sdk.Ribbon.RibbonControl);SparkleXrm.Sdk.Ribbon.RibbonMenu.registerClass('SparkleXrm.Sdk.Ribbon.RibbonMenu');SparkleXrm.Sdk.Ribbon.RibbonMenuSection.registerClass('SparkleXrm.Sdk.Ribbon.RibbonMenuSection');SparkleXrm.Services.CachedOrganizationService.registerClass('SparkleXrm.Services.CachedOrganizationService');SparkleXrm.Services.OrganizationServiceCache.registerClass('SparkleXrm.Services.OrganizationServiceCache');SparkleXrm.Xrm.PageEx.majorVersion=0;(function(){SparkleXrm.Xrm.PageEx.majorVersion=2011;if(typeof(window.APPLICATION_VERSION)!=='undefined'){var $0=window.APPLICATION_VERSION;if($0!=='5.0'){SparkleXrm.Xrm.PageEx.majorVersion=2013;}}})();
SparkleXrm.Sdk.AttributeTypes.string_='string';SparkleXrm.Sdk.AttributeTypes.decimal_='decimal';SparkleXrm.Sdk.AttributeTypes.int_='int';SparkleXrm.Sdk.AttributeTypes.double_='double';SparkleXrm.Sdk.AttributeTypes.dateTime_='dateTime';SparkleXrm.Sdk.AttributeTypes.boolean_='boolean';SparkleXrm.Sdk.AttributeTypes.entityReference='EntityReference';SparkleXrm.Sdk.AttributeTypes.guid_='guid';SparkleXrm.Sdk.AttributeTypes.optionSetValue='OptionSetValue';SparkleXrm.Sdk.AttributeTypes.aliasedValue='AliasedValue';SparkleXrm.Sdk.AttributeTypes.entityCollection='EntityCollection';SparkleXrm.Sdk.AttributeTypes.money='Money';SparkleXrm.Sdk.OrganizationSettings.entityLogicalName='organization';SparkleXrm.Sdk.UserSettingsAttributes.userSettingsId='usersettingsid';SparkleXrm.Sdk.UserSettingsAttributes.businessUnitId='businessunitid';SparkleXrm.Sdk.UserSettingsAttributes.calendarType='calendartype';SparkleXrm.Sdk.UserSettingsAttributes.currencyDecimalPrecision='currencydecimalprecision';SparkleXrm.Sdk.UserSettingsAttributes.currencyFormatCode='currencyformatcode';SparkleXrm.Sdk.UserSettingsAttributes.currencySymbol='currencysymbol';SparkleXrm.Sdk.UserSettingsAttributes.dateFormatCode='dateformatcode';SparkleXrm.Sdk.UserSettingsAttributes.dateFormatString='dateformatstring';SparkleXrm.Sdk.UserSettingsAttributes.dateSeparator='dateseparator';SparkleXrm.Sdk.UserSettingsAttributes.decimalSymbol='decimalsymbol';SparkleXrm.Sdk.UserSettingsAttributes.defaultCalendarView='defaultcalendarview';SparkleXrm.Sdk.UserSettingsAttributes.defaultDashboardId='defaultdashboardid';SparkleXrm.Sdk.UserSettingsAttributes.localeId='localeid';SparkleXrm.Sdk.UserSettingsAttributes.longDateFormatCode='longdateformatcode';SparkleXrm.Sdk.UserSettingsAttributes.negativeCurrencyFormatCode='negativecurrencyformatcode';SparkleXrm.Sdk.UserSettingsAttributes.negativeFormatCode='negativeformatcode';SparkleXrm.Sdk.UserSettingsAttributes.numberGroupFormat='numbergroupformat';SparkleXrm.Sdk.UserSettingsAttributes.numberSeparator='numberseparator';SparkleXrm.Sdk.UserSettingsAttributes.offlineSyncInterval='offlinesyncinterval';SparkleXrm.Sdk.UserSettingsAttributes.pricingDecimalPrecision='pricingdecimalprecision';SparkleXrm.Sdk.UserSettingsAttributes.showWeekNumber='showweeknumber';SparkleXrm.Sdk.UserSettingsAttributes.systemUserId='systemuserid';SparkleXrm.Sdk.UserSettingsAttributes.timeFormatCodestring='timeformatcodestring';SparkleXrm.Sdk.UserSettingsAttributes.timeFormatString='timeformatstring';SparkleXrm.Sdk.UserSettingsAttributes.timeSeparator='timeseparator';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneBias='timezonebias';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneCode='timezonecode';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightBias='timezonedaylightbias';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightDay='timezonedaylightday';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightDayOfWeek='timezonedaylightdayofweek';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightHour='timezonedaylighthour';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightMinute='timezonedaylightminute';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightMonth='timezonedaylightmonth';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightSecond='timezonedaylightsecond';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneDaylightYear='timezonedaylightyear';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardBias='timezonestandardbias';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardDay='timezonestandardday';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardDayOfWeek='timezonestandarddayofweek';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardHour='timezonestandardhour';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardMinute='timezonestandardminute';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardMonth='timezonestandardmonth';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardSecond='timezonestandardsecond';SparkleXrm.Sdk.UserSettingsAttributes.timeZoneStandardYear='timezonestandardyear';SparkleXrm.Sdk.UserSettingsAttributes.transactionCurrencyId='transactioncurrencyid';SparkleXrm.Sdk.UserSettingsAttributes.uiLanguageId='uilanguageid';SparkleXrm.Sdk.UserSettingsAttributes.workdayStartTime='workdaystarttime';SparkleXrm.Sdk.UserSettingsAttributes.workdayStopTime='workdaystoptime';SparkleXrm.Sdk.UserSettings.entityLogicalName='usersettings';SparkleXrm.Sdk.Guid.empty=new SparkleXrm.Sdk.Guid('00000000-0000-0000-0000-000000000000');SparkleXrm.Sdk.OrganizationServiceProxy.withCredentials=false;SparkleXrm.Sdk.OrganizationServiceProxy.userSettings=null;SparkleXrm.Sdk.OrganizationServiceProxy.executeMessageResponseTypes={};SparkleXrm.Sdk.OrganizationServiceProxy.organizationSettings=null;SparkleXrm.Sdk.XmlHelper._encode_map={'&':'&amp;','"':'&quot;','<':'&lt;','>':'&gt;',"'":'&#39;'};SparkleXrm.Sdk.XmlHelper._decode_map={'&amp;':'&','&quot;':'"','&lt;':'<','&gt;':'>','&#39;':"'"};SparkleXrm.Sdk.Metadata.MetadataCache.$0={};SparkleXrm.Sdk.Metadata.MetadataCache.$1={};SparkleXrm.Sdk.Metadata.MetadataCache.$2={};SparkleXrm.Services.CachedOrganizationService.cache=new SparkleXrm.Services.OrganizationServiceCache();});